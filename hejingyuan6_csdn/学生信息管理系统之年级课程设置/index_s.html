<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; 学生信息管理系统之年级课程设置</div><div style="color:blue" align=center>学生信息管理系统之年级课程设置</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p><span style="font-size:18px">大家先来看一下它的窗口布局</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img alt="" src="23217265816836.png"><br>
</span></p>
<p><span style="font-size:18px">年级是默认加载的，但是当我们选择年级时，如果此年级已经设置好了课程，那么在已经选择课程中应该显示出来，当我们单击设置课程时，此年级的所有课程也应该显示，当然这些都很简单</span></p>
<p><span style="font-size:18px">第一个显示所选课程我们只需在单击选择年级时，执行</span></p>
<p>
<pre class="plain" name="code"><span style="font-size:18px;">&nbsp;ListSelectCourse(1).Clear &nbsp; '先清空列表
&nbsp; &nbsp; &nbsp;&nbsp;
&nbsp; &nbsp; &nbsp; '从年级课程里查找出相同年级的信息，将课程名称添加到列表里
&nbsp; &nbsp; &nbsp; txtsql = &quot;select*from gradecourse_info where grade='&quot; &amp; ComboGra.Text &amp; &quot;'&quot;
&nbsp; &nbsp; &nbsp; Set mrc = executesql(txtsql, msgtext)
&nbsp; &nbsp; &nbsp; &nbsp;If Not mrc.EOF Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To mrc.RecordCount
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ListSelectCourse(1).AddItem mrc.Fields(1)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mrc.MoveNext
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next
&nbsp; &nbsp; &nbsp; &nbsp;End If
&nbsp; &nbsp; mrc.Close</span></pre>
<p><span style="font-size:18px">&nbsp;第二个显示，执行</span></p>
<p><span style="font-size:18px"></span><pre class="plain" name="code"><span style="font-size:18px;">  '先将以前的课程清空，在重新添加所有课程
      ListAllCourse(0).Clear
      ListAllCourse(0).Enabled = True
      ListSelectCourse(1).Enabled = True
      CmdModify.Enabled = True
      
      txtsql = &quot;select * from course_info&quot;
      Set mrc = executesql(txtsql, msgtext)   '添加信息
       While (mrc.EOF = False)             
          ListAllCourse(0).AddItem mrc.Fields(1)
          mrc.MoveNext
       Wend
       mrc.Close</span></pre><span style="font-size:18px">&nbsp;但是，当我们单击确认设置时，它是如何避免年级重复，如何思考的，下面我们来看看这段代码</span></p>
<p>
<p>
<p>
<p><pre class="plain" name="code"><span style="font-size:18px;"> txtsql = &quot;select * from gradecourse_info where grade='&quot; &amp; ComboGra.Text &amp; &quot;'&quot;
     Set mrc = executesql(txtsql, msgtext)
       If mrc.EOF Then    '如果是新添加的年级则将已选的课程添加进去
          For i = 1 To ListSelectCourse(1).ListCount
             mrc.AddNew
             mrc.Fields(0) = Trim(ComboGra.Text)
             mrc.Fields(1) = Trim(ListSelectCourse(1).List(i - 1))
             mrc.Update
          Next
          mrc.Close
          MsgBox &quot;设置课程成功&quot;
       Else
          mrc.Close   '如果是已存在的年级就将这个年级删除再重新添加
          txtsql = &quot;delete from gradecourse_info where grade='&quot; &amp; ComboGra.Text &amp; &quot;'&quot;
          Set mrc = executesql(txtsql, msgtext)
          
         txtsql = &quot;select * from gradecourse_info&quot;
         Set mrc = executesql(txtsql, msgtext)
           For i = 1 To ListSelectCourse(1).ListCount
             mrc.AddNew
             mrc.Fields(0) = Trim(ComboGra.Text)
             mrc.Fields(1) = Trim(ListSelectCourse(1).List(i - 1))
             mrc.Update
           Next
           mrc.Close
          'mrcc.Close
          MsgBox &quot;设置课程成功&quot;
          
        End If</span></pre><span style="font-size:18px"><br>
&nbsp; &nbsp; &nbsp; &nbsp;这些内容都不是很难，主要是我们要明白它的思考过程，为什么要这样做？然后我们以后做系统，不光只是敲代在敲之前要多思考，一个好的程序员不光只是要实现这个功能，还要思考如何让自己的代码简单，干练，实现能力更强！<br>
&nbsp;&nbsp;&nbsp;</span></p>
<p>
<p>
<p>
<p><br>
</p>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/7800639'>原文链接</a>