<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; DropDownList控件的使用</div><div style="color:blue" align=center>DropDownList控件的使用</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">关于下拉菜单</span><span lang="en-US">(dropdownlist)</span><span lang="en-US">一些用法</span><span lang="zh-CN">：</span><span lang="en-US"></span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">DropDownListWeb控件创建一个包含多个选项的下拉列表，用户可以从中选择一个选项。</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">1</span><span lang="zh-CN">，动态绑定数据</span><span lang="en-US">(</span><span lang="zh-CN">与</span><span lang="en-US">datatable</span><span lang="zh-CN">绑定</span><span lang="en-US">)</span><span lang="zh-CN">：</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px"></span></span></p>
<pre name="code" class="csharp"> #region 绑定设置dropdownlist的值
        /// &lt;summary&gt;
        /// 绑定设置dropdownlist的值
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ddl&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;dt&quot;&gt;&lt;/param&gt;
        private void SetDropDownList(DropDownList ddl, DataTable dt)
        {
            //清空原有数据
            ddl.Items.Clear();
            //判断是否有需要填充的数据，有则填充
            if (dt.Rows.Count &gt; 0)
            {
                ddl.DataSource = dt;//绑定数据源
                ddl.DataValueField = dt.Columns[0].ToString();//绑定数据项Value
                ddl.DataTextField = dt.Columns[2].ToString();//绑定数据项Text
                ddl.DataBind();//绑定
            }

            ddl.Items.Add(new ListItem(&quot;请选择&quot;, &quot;&quot;));//填充请【选择项】
            ddl.SelectedIndex = ddl.Items.Count - 1;//选中【请选择】项
        }

 #endregion
</pre><br>
<br>
<p>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px"></span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">若要指定绑定后的数据选定项</span></span><span lang="zh-CN" style="font-family:KaiTi_GB2312; font-size:24px">可使用</span></p>
<p style="margin:0in"><span lang="en-US" style="font-family:KaiTi_GB2312; font-size:24px">DropDownList.Items.FindByText(&quot;name&quot;).Selected=true</span><span lang="en-US" style="font-family:KaiTi_GB2312; font-size:24px">或者</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">DropDownList.Items.FindByValue(&quot;code&quot;).Selected=true</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">另外也可从数据库中获得选定项</span><span lang="en-US">(</span><span lang="en-US">比如修改信息的时候</span><span lang="en-US">)</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">可使用先用数据库填充一个</span><span lang="en-US">DateSet--ds,</span><span lang="en-US">然后使用</span><span lang="en-US">DropDownList.Items.FindByValue/*</span><span lang="en-US">或者</span><span lang="en-US">FindByText*/(ds.Tables[0].Rows[0].ItemArray[0].ToString()).Selected=true;</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">实际应用：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">1</span><span lang="zh-CN">，从查询页面中点击编辑跳转到编辑页面</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">2</span><span lang="zh-CN">，编辑完成，提示修改成功后，跳转到查询页面的跳转的状态</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">查询页面：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<pre name="code" class="csharp">        /// &lt;summary&gt;
        /// 点击编辑，获取编辑的id, 即须知id
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void lbtnEdit_Click(object sender, EventArgs e)
        {
            LinkButton editbtn = (LinkButton)sender;
            string ExamID = DropExam.SelectedItem.Value;
            //获取被编辑字典的ID
            string NoticeID = editbtn.CommandArgument.ToString();
            Response.Redirect(&quot;ExamNotice.aspx?NoticeID=&quot; + NoticeID + &quot;&amp;ExamID=&quot; + ExamID);
            //&quot;ModifyExamStudentInformation.aspx?StudentNo=&quot; + parmStr[0] + &quot;&amp;ExamMainID=&quot; + parmStr[1]
        }
</pre><br>
<br>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px">修改页面：<br>
</span></span></p>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px"></span></span></p>
<pre name="code" class="csharp">                /// &lt;summary&gt;
	        /// 点击修改
	        /// &lt;/summary&gt;
	        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
	        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
	        protected void btnOK_Click(object sender, EventArgs e)
	        {
	            try
	            {
	
	                TeaExamInformationBLL teaExamInformationBLL = new TeaExamInformationBLL();
	                //定义一个考试申请实体类
	                string NoticeID = Request.QueryString[&quot;NoticeID&quot;];
	                string ExamID = Request.QueryString[&quot;ExamID&quot;];
	                ExamNoticeEntity enExamNotice = new ExamNoticeEntity();
	                enExamNotice.NoticeID = NoticeID;
	                enExamNotice.Notice = txtContent.Text;
	                enExamNotice.IsNoUse = IsUse.SelectedItem.Text;
	                enExamNotice.NoticeName = txtNoticeName.Text;
	                //enExamNotice.AddUser = &quot;何静媛&quot;;
	                enExamNotice.AddUser = Session[&quot;UserName&quot;].ToString();
	                //enExamNotice.IsNoDefault = IsDefault.SelectedItem.Text;
	                //声明错误枚举
	                ConfirmInfo flagUpdateExamNotice;
	                //判断如果想要设置默认须知
	                flagUpdateExamNotice = teaExamInformationBLL.UpdateExamInformation(enExamNotice);
	                if (ConfirmInfo.Success == flagUpdateExamNotice)
	                {
	                    Page.ClientScript.RegisterStartupScript(Page.GetType(), &quot;message&quot;, &quot;&lt;script language=&#39;javascript&#39; defer&gt;alert(&#39;修改考试须知信息成功！&#39;);&lt;/script&gt;&quot;);
	                    //修改成功
	                    //Page.ClientScript.RegisterStartupScript(Page.GetType(), &quot;&quot;, &quot;location.href=&#39;SearchInformation.aspx?ExamID=&#39;&quot; + ExamID, true);
	                    Response.Redirect(&quot;SearchInformation.aspx&quot;);
	
	
	                }
	                //代码已经存在
	                else if (ConfirmInfo.Exists == flagUpdateExamNotice)
	                {
	                    Page.ClientScript.RegisterStartupScript(Page.GetType(), &quot;message&quot;, &quot;&lt;script language=&#39;javascript&#39; defer&gt;alert(&#39;修改为默认须知失败！&#39;);&lt;/script&gt;&quot;);
	                }
	                else
	                {
	                    Page.ClientScript.RegisterStartupScript(Page.GetType(), &quot;message&quot;, &quot;&lt;script language=&#39;javascript&#39; defer&gt;alert(&#39;修改考试须知信息失败！&#39;);&lt;/script&gt;&quot;);
	                }
	            }
	            catch (Exception ex)
	            {
	                MessageBox.Show(this.Page, ex.Message);
	            }
	
	        }
</pre><br>
<br>
<p>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px">点击修改，修改成功后，跳转回查询页面：<br>
</span></span></p>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px"></span></span></p>
<pre name="code" class="csharp"> protected void Page_Load(object sender, EventArgs e)
        {
            if (Session[&quot;UserNO&quot;] != null)
            {
              
                if (!IsPostBack)
                {
                    //页面首次加载时给表格绑定数据

                    BindAllCollege();
                    //判断学院的下拉框是否为空,即判断session中的学院是否为空
                    if (Session[&quot;SelectedCollegeID&quot;] == null)
                    {
                        BindAllCollege();

                    }                      
                    else
                    {
                        //如果学院的session中不为空，则将下拉框加载上数据，并附上选中项
                        BindAllCollege();
                        //先清空选中项
                        DropDep.ClearSelection();
                        //给下拉框赋上选中项
                        DropDep.Items.FindByValue(Session[&quot;SelectedCollegeID&quot;].ToString()).Selected = true;
                        //DropExamRoom.Items.FindByText(ExamRoom).Selected = true;

                        BindCourseByID();
                        DropCourse.ClearSelection();
                        DropCourse.Items.FindByValue(Session[&quot;SelectedCourseID&quot;].ToString()).Selected = true;

                        BindExamByCourseID();
                        DropExam.ClearSelection();
                        DropExam.Items.FindByValue(Session[&quot;SelectedExamID&quot;].ToString()).Selected = true;

                        //定义B层类
                        TeaExamInformationBLL teaExamInformationBLL = new TeaExamInformationBLL();
                        //定义一个考试须知实体类
                        TR_ExamNoticeEntity enExamNoticeRelative = new TR_ExamNoticeEntity();
                        enExamNoticeRelative.ExamID = DropExam.SelectedItem.Value;
                        enExamNoticeRelative.AddUser = Session[&quot;UserName&quot;].ToString();
                        //enExamNoticeRelative.AddUser = &quot;何静媛&quot;;

                        DataTable dtExamNotice = teaExamInformationBLL.QueryExamInformation(enExamNoticeRelative);
                        if (dtExamNotice.Rows.Count == 0)
                        {
                            //MessageBox.Show(this, &quot;此考试下还未添加考试须知！系统默认应用默认须知&quot;);
                            lblMessage.Text = &quot;此考试下还未添加考试须知！系统默认应用默认须知&quot;;
                        }
                        repExamNotic.DataSource = dtExamNotice;
                        repExamNotic.DataBind();

                    }
                }
            }
            else
            {
                Response.Redirect(&quot;../../Student/StuLogin.aspx&quot;);
            }     
           
        }
</pre><br>
<br>
<p>
<p style="margin:0in"><span lang="zh-CN"></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">2.</span><span lang="zh-CN">查询用法</span><span lang="en-US"></span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">对于单个下拉菜单查询我一般直接使用</span><span lang="en-US">SelectedIndexChanged</span><span lang="en-US">事件</span><span lang="en-US">,</span><span lang="en-US">使用这个事件千万别忘记把下拉菜单的</span><span lang="en-US">AutoPostBack</span><span lang="en-US">属性设为</span><span lang="en-US">true!&nbsp;</span></span></p>
<br>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px"></span></span></p>
<pre name="code" class="csharp">        /// &lt;summary&gt;
        /// 学院变化时加载课程
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void dropCollege_SelectedIndexChanged(object sender, EventArgs e)
        {
            //绑定课程
            BindCourseByID();
        }

 #region 绑定学院

        /// &lt;summary&gt;
        /// 绑定学院
        /// &lt;/summary&gt;
        private void BindAllCollege()
        {
            DataTable dtCollege = new DataTable();
            BasicSystemBLL BasicSystemBll = new BasicSystemBLL();
            dtCollege = BasicSystemBll.GetAllCollege();

            //判断是否有学院
            if (dtCollege.Rows.Count == 0)
            {
                MessageBox.Show(this, &quot;没有学院，请联系管理员！&quot;);
                DropDep.Items.Clear();
                //dropDepartment.Items.Clear();
                DropCourse.Items.Clear();
                DropExam.Items.Clear();
                //DropExamRoom.Items.Clear();
            }
            else
            {
                SetDropDownList(DropDep, dtCollege);
                DropExam.Items.Clear();
                //DropExamRoom.Items.Clear();
            }
        }

 #endregion
</pre><br>
<p>
<p style="margin:0in"><span lang="zh-CN"></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">3</span><span lang="zh-CN">，添加用法</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">添加</span><span lang="en-US">DorpDownList</span><span lang="en-US">控件的</span><span lang="en-US">Item</span><span lang="en-US">子项的三种方法</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">DropDownList</span><span lang="zh-CN">控件的</span><span lang="en-US">SelectedItem</span><span lang="en-US">对象表示在执行过程中被选中的</span><span lang="en-US">Item</span><span lang="en-US">项</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">Item项拥有三个属性。其一为Text,其二为Value它们分别表示Item项所显示的文字与所表示的&#20540;，如果Value属性没有设置，则默认Value属性&#20540;等Text属性，第三个属性Selected则用于判断某Item项是否被选中添加DorpDownList控件的Item子项。</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">添加</span><span lang="en-US">DorpDownList</span><span lang="en-US">控件的</span><span lang="en-US">Item</span><span lang="en-US">子项的方法有三种：</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">第一种：使用</span><span lang="en-US">&lt;asp:ListItem&gt;</span><span lang="en-US">方法</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"></span></p>
<pre name="code" class="html">&lt;asp:DropDownList id=&quot;weste&quot; runat=&quot;server&quot;&gt;
          &lt;asp:ListItem Value=&quot;0&quot;&gt;小学&lt;/asp:ListItem&gt;
          &lt;asp:ListItem Value=&quot;1&quot;&gt;中学&lt;/asp:ListItem&gt;
          &lt;asp:ListItem Value=&quot;2&quot;&gt;大学&lt;/asp:ListItem&gt;
&lt;/asp:DropDownList&gt;
</pre><br>
<p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">第二种：使用</span><span lang="en-US">Items</span><span lang="en-US">属性的</span><span lang="en-US">Add</span><span lang="en-US">方法</span><span lang="en-US">1</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">DropDownList.Items.Add(ItemText)</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">Items</span><span lang="zh-CN">属性表示</span><span lang="en-US">DropDownList</span><span lang="en-US">控件所有</span><span lang="en-US">Item</span><span lang="en-US">项的集合，</span><span lang="en-US">Add</span><span lang="en-US">操作既是在这个集合中插入新的</span><span lang="en-US">Item</span><span lang="en-US">项。第二种方法用于只设定</span><span lang="en-US">Item</span><span lang="en-US">项的</span><span lang="en-US">Text</span><span lang="en-US">属性（实际上也指定了</span><span lang="en-US">Value</span><span lang="en-US">属性，此时</span><span lang="en-US">Value</span><span lang="en-US">属性&#20540;等于</span><span lang="en-US">Text</span><span lang="en-US">属性&#20540;）。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">第三种：使用</span><span lang="en-US">Items</span><span lang="en-US">属性的</span><span lang="en-US">Add</span><span lang="en-US">方法</span><span lang="en-US">2</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">DropDownListItems.Add(newListItem(ItemText,ItemValue))</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">第三种方法同时设定了</span><span lang="en-US">Item</span><span lang="en-US">项的</span><span lang="en-US">Text</span><span lang="en-US">属性与</span><span lang="en-US">Value</span><span lang="en-US">属性，它是通过添加一个</span><span lang="en-US">ListItem</span><span lang="en-US">类来实现的。</span><span lang="en-US">ListItem</span><span lang="en-US">类使用了两个参数，第一个参数表示</span><span lang="en-US">Text</span><span lang="en-US">属性&#20540;，第二个参数表示</span><span lang="en-US">Value</span><span lang="en-US">属性&#20540;。</span></span></p>
<p lang="en-US" style="margin:0in"><br>
</p>
<p lang="en-US" style="margin:0in"><br>
</p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">DropDownList要加载之后要按照我们查到的数据显示，这只是一种方式，可能还会有更好的方法，在这里只是提供一种方式，也多方面了解一下DropDownList的用法！</span></p>
<span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span>
<p lang="en-US" style="margin:0in"><br>
</p>
<br>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/16847119'>原文链接</a>