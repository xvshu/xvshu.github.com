<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; SQLServer数据转换</div><div style="color:blue" align=center>SQLServer数据转换</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p><span style="font-size:18px"><span style="color:#660000">数据转换服务的概念</span></span></p>
<p><span style="font-size:18px"><br>
</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;通常数据总是以不同的&#26684;式，存储在不同的地方，有的可能是文本文件，有的虽然具有表结构但不属于同一种数据源。这些情况极大地妨碍了数据的集中处理。为此SQL Server提供了DTS（Data Transformation Servers）组件。</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;DTS本身包含多个工具，并提供了接口来实现在任何支持OLEDB的数据源间导入，导出或传递数据，并使这一工作变得简单，高效。</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;利用DTS可能在任何OLEDB，ODBC 驱动程序的数据源或文本文件和SQL Server之间导入导出或传递数据具体<span style="color:#cc6600">表现</span>在：</span></p>
<p><span style="font-size:18px"><span style="color:#cc6600">数据的导入导出服务</span>：</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;通过读写数据在不同应用程序间交换数据。例如：可以将文本文件或Microsoft Access数据库导入到SQL Server，也可以把数据从SQL Server导出到任何OLEDB数据源。</span></p>
<p><span style="font-size:18px"><span style="color:#cc6600">转换数据</span>：</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;所谓传递是指在数据未到达目标数据源前而对数据采取的系列操作。比如：DTS允许从源数据源的一列或多列计算出新的列&#20540;，然后将其存储在目标数据库中。</span></p>
<p><span style="font-size:18px"><span style="color:#cc6600">传递数据库对象</span></span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;在异构数据源情况下，DTS的内置工具只能在数据源间传递表定义和数据。如果要传递其他数据库对象，如索引，约束，视图时，必须定义一个任务，从而在目标数据库上执行那些包含在任务中的SQL语句，SQL语句是被用来创建这些数据库对象的。</span></p>
<p><span style="font-size:18px">DTS结构</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; DTS将数据导入，导出或传递定义成可存储的对象，即包裹或称为包，每一个包都是包括一个或具有一定顺序的多个任务的工作流，每个任务可以将数据从某一数据源拷贝至目标数据源，或使用Active脚本转换数据，或执行SQL语句，或运行外部程序。也可以在SQL Server数据源间传递数据库对象。包对象用来创建并存储步骤，这些步骤定义了一系列任务执行的顺序，以及执行任务的必要细节。</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; 包是顶层对象，它包含三种底层对象：<span style="color:#000066">连接，任务，步骤</span>。</span></p>
<p><span style="font-size:18px">连接：定义了有关源和目标数据的信息，这些信息包括数据&#26684;式和位置以及安全认证的密码。DTS可不包含或包含多个连接</span></p>
<p><span style="font-size:18px">任务：每个DTS包都含有一个或多个任务，每个任务都是数据转换（传递）处理的工作项目。</span></p>
<p><span style="font-size:18px">步骤：步骤对象定义了任务执行的顺序，以及某一任务的执行是否依赖前一任务的结果。步骤的一个重要特性是步骤的优先权约束。</span></p>
<p><span style="font-size:18px">&nbsp;</span></p>
<p><span style="font-size:18px"><span style="color:#660000">数据的导入</span></span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;方法一：用企业管理器</span></p>
<p><span style="font-size:18px">1，&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打开企业管理器，打开要导入数据的数据库，在表上按右键，所有任务——导入数据，弹出DTS导入/导出向导，按下一步</span></p>
<p><span style="font-size:18px">2，&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;选择数据源，即要导入的文件，按下一步</span></p>
<p><span style="font-size:18px">3，&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;选择目的，选择Microsoft OLEDB 提供程序，选择数据库服务器，然后单击必要的身份验证方式。按下一步</span></p>
<p><span style="font-size:18px">4，&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在指定表&#26684;复制或查询对话框中，单击复制表&#26684;</span></p>
<p><span style="font-size:18px">5，&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在选择源表&#26684;对话框中，单击全部选定。下一步，完成。</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp; 方法二：Transact—SQL语句</span></p>
<p><span style="font-size:18px"><span style="color:#660000">数据的导出</span></span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;方法一：用企业管理器</span></p>
<p><span style="font-size:18px">1，&nbsp; 打开企业管理器，打开要导入数据的数据库，在表上按右键，所有任务——导入数据，弹出DTS导入/导出向导，按下一步</span></p>
<p><span style="font-size:18px">2，单击下一步就会出现导出数据源对话框</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp;&nbsp;<img src="241512910213833.png" alt="">&nbsp; &nbsp;</span></p>
<p><span style="font-size:18px">3，单击下一步，则选择目的对话框</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp;<img src="42614129825494.png" alt=""><br>
</span></p>
<p><span style="font-size:18px">4，单击下一步，则出现指定表复制或查询对话框</span></p>
<p><span style="font-size:18px">&nbsp;&nbsp;<img src="6972088328350.png" alt=""><br>
</span></p>
<p><span style="font-size:18px">5，单击下一步，选择源表和视图对话框</span></p>
<p><span style="font-size:18px"><img src="652458330534.png" alt=""><br>
</span></p>
<p><span style="font-size:18px">6，</span></p>
<p><span style="font-size:18px">&nbsp;<img src="4955458086171.png" alt=""><br>
</span></p>
<p><span style="font-size:18px"><br>
</span></p>
<p><img src="30266626993037.png" alt=""><img src="40299988209416.png" alt=""></p>
<p><span style="font-size:18px"><img src="23889019933615.png" alt=""></span><span style="font-size:18px"><img src="24497137325778.png" alt=""><img src="4459015409870.png" alt=""></span></p>
<p><span style="font-size:18px">8，</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp;<img src="13293358449811.png" alt=""><br>
</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size:18px">方法二：Transact—SQL语句</span></span></p>
<p><span style="font-size:18px"><span style="font-size:18px"><br>
</span></span></p>
<p><span style="font-size:18px"><span style="font-size:18px"><br>
</span></span></p>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/7709476'>原文链接</a>