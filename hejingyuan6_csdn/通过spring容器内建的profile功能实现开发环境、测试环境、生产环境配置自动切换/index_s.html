<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; 通过spring容器内建的profile功能实现开发环境、测试环境、生产环境配置自动切换</div><div style="color:blue" align=center>通过spring容器内建的profile功能实现开发环境、测试环境、生产环境配置自动切换</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">
<p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;">软件开发的一般流程为工程师开发 -&gt; 测试 -&gt; 上线，因此就涉及到三个不同的环境，开发环境、测试环境以及生产环境，通常这三个环境会有很多配置参数不同，例如数据源、文件路径、url等，如果每次上线一个新版本时都手动修改配置会十分繁琐，容易出错。spring 为我们提供了 profile 机制来解决这个问题。</p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><br style="box-sizing: border-box; margin: 0px;"></p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;">spring允许我们通过定义 profile 来将若干不同的 bean 定义组织起来，从而实现不同环境自动激活不同的 profile 来切换配置参数的功能，下面介绍以 xml 的方式定义 profile、如何激活 profile以及定义默认的 profile，整个过程我以配置不同环境的数据源为例，为了简化配置，这里假设只有开发和生产两个环境。</p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><br style="box-sizing: border-box; margin: 0px;"></p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;">数据源定义为</p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_1_1229902" code_snippet_id="1661280" snippet_file_name="blog_20160425_1_1229902" name="code" class="html">&lt;bean id=&quot;dataSource&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt;
    &lt;property name=&quot;user&quot; value=&quot;${jdbc.user}&quot; /&gt; 
    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot; /&gt; 
    &lt;property name=&quot;jdbcUrl&quot; value=&quot;${jdbc.jdbcUrl}&quot; /&gt;   
    &lt;property name=&quot;driverClass&quot; value=&quot;${jdbc.driverClass}&quot; /&gt;
    &lt;property name=&quot;initialPoolSize&quot; value=&quot;${c3p0.initialPoolSize}&quot;/&gt;
    &lt;property name=&quot;acquireIncrement&quot; value=&quot;${c3p0.acquireIncrement}&quot;/&gt;
    &lt;property name=&quot;minPoolSize&quot; value=&quot;${c3p0.minPoolSize}&quot;/&gt;
    &lt;property name=&quot;maxIdleTime&quot; value=&quot;${c3p0.maxIdleTime}&quot;/&gt;
    &lt;property name=&quot;idleConnectionTestPeriod&quot; value=&quot;${c3p0.idleConnectionTestPeriod}&quot; /&gt;
    &lt;property name=&quot;preferredTestQuery&quot; value=&quot;${c3p0.preferredTestQuery}&quot;/&gt;
&lt;/bean&gt;</pre><br><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;">classpath下外部资源文件有两个&nbsp;settings-development.properties 和&nbsp;settings-production.properties，分别是开发环境和生产环境的数据源配置参数，内容如下</span><p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><br style="box-sizing: border-box; margin: 0px;"></p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="box-sizing: border-box; margin: 0px;">settings-development.properties</span></p><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_2_6486391" code_snippet_id="1661280" snippet_file_name="blog_20160425_2_6486391" name="code" class="html">jdbc.user=root
jdbc.password=111111
jdbc.driverClass=com.mysql.jdbc.Driver
jdbc.jdbcUrl=jdbc:mysql://localhost:3306/xxx
c3p0.minPoolSize=5 
c3p0.initialPoolSize=5
c3p0.acquireIncrement=5
c3p0.maxIdleTime=3600
c3p0.idleConnectionTestPeriod=3600
c3p0.preferredTestQuery=select 1</pre><br><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;">settings-production.properties</span><br><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"></span></p><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_3_8296535" code_snippet_id="1661280" snippet_file_name="blog_20160425_3_8296535" name="code" class="html">jdbc.user=xxx
jdbc.password=xxxx
jdbc.driverClass=com.mysql.jdbc.Driver
jdbc.jdbcUrl=jdbc:mysql:///xxx
c3p0.minPoolSize=20 
c3p0.initialPoolSize=20
c3p0.acquireIncrement=10
c3p0.maxIdleTime=3600
c3p0.idleConnectionTestPeriod=3600
c3p0.preferredTestQuery=select 1</pre><br><h4 style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 18px; margin: 10px 0px; font-weight: 500; line-height: 1.1; color: rgb(85, 85, 85);"><span style="box-sizing: border-box; font-size: 14px; margin: 0px; font-weight: 600;">1. 定义 profile</span></h4><p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;">现在就可以通过定义 profile 来将开发和生产环境的数据源配置分开，这里我们定义两个 profile，一个名称是 development，另一个名称是 production（配置到Spring的配置文件中即可）</p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"></span></p><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_4_6518628" code_snippet_id="1661280" snippet_file_name="blog_20160425_4_6518628" name="code" class="html">&lt;!-- 开发环境配置文件 --&gt;
&lt;beans profile=&quot;development&quot;&gt;
    &lt;context:property-placeholder location=&quot;classpath:settings-development.properties&quot;/&gt;
&lt;/beans&gt;
 
&lt;!-- 生产环境配置文件 --&gt;
&lt;beans profile=&quot;production&quot;&gt;
    &lt;context:property-placeholder location=&quot;classpath:settings-production.properties&quot;/&gt;
&lt;/beans&gt;
</pre><br><h4 style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 18px; margin: 10px 0px; font-weight: 500; line-height: 1.1; color: rgb(85, 85, 85);"><span style="box-sizing: border-box; font-size: 14px; margin: 0px; font-weight: 600;">2. 定义默认 profile</span></h4><p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="box-sizing: border-box; margin: 0px;">默认 profile 是指在没有任何 profile 被激活的情况下，默认 profile 内定义的内容将被使用，通常可以在 web.xml 中定义全局 servlet 上下文参数&nbsp;spring.profiles.default&nbsp;实现，代码如下</span></p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"></span></p><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_5_280620" code_snippet_id="1661280" snippet_file_name="blog_20160425_5_280620" name="code" class="html">&lt;!-- 配置spring的默认profile --&gt;
&lt;context-param&gt;
    &lt;param-name&gt;spring.profiles.default&lt;/param-name&gt;
    &lt;param-value&gt;development&lt;/param-value&gt;
&lt;/context-param&gt;</pre><br><p>当然此种方式也是使用默认profile的方式，即如果不指定激活哪个环境则使用默认方式加载文件</p><p><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_6_5288330" name="code" class="html"> &lt;beans profile=&quot;default&quot;&gt;
        &lt;context:property-placeholder ignore-resource-not-found=&quot;true&quot; location=&quot;classpath:application.properties&quot;/&gt;
    &lt;/beans&gt;</pre><br><br></p><h4 style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 18px; margin: 10px 0px; font-weight: 500; line-height: 1.1; color: rgb(85, 85, 85);"><br style="box-sizing: border-box; font-size: 14px; margin: 0px;"><span style="box-sizing: border-box; font-size: 14px; margin: 0px; font-weight: 600;">3. 激活 profile （目前采用的方式）</span></h4><p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;">spring 为我们提供了大量的激活 profile 的方法，可以通过代码来激活，也可以通过系统环境变量、JVM参数、servlet上下文参数来定义&nbsp;spring.profiles.active 参数激活 profile，这里我们通过定义 JVM 参数实现。</p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;">在生产环境中，以 tomcat 为例，我们在 tomcat 的启动脚本中加入以下 JVM 参数</p><div style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><div id="highlighter_983869" class="syntaxhighlighter  bash" style="box-sizing: border-box; width: 805.5px; font-size: 1em !important; margin: 1em 0px !important; position: relative !important; overflow: auto !important;"><table border="0" cellpadding="0" cellspacing="0" style="border-spacing: 0px; border-collapse: collapse; width: 805px; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-size: 1em !important; margin: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: inherit !important; background: none !important;"><tbody style="box-sizing: content-box !important; font-size: 1em !important; margin: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: inherit !important; background: none !important;"><tr style="box-sizing: content-box !important; font-size: 1em !important; margin: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: inherit !important; background: none !important;"><td class="gutter" style="box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-size: 1em !important; margin: 0px !important; padding: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: inherit !important; color: rgb(175, 175, 175) !important; background: none !important;"><div class="line number1 index0 alt2" style="box-sizing: content-box !important; font-size: 1em !important; margin: 0px !important; border-radius: 0px !important; border-width: 0px 3px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; padding: 0.2em 0.5em 0.2em 1em !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: inherit !important; white-space: pre !important; background-image: none !important; background-attachment: initial !important; background-size: initial !important; background-origin: initial !important; background-clip: initial !important; background-position: initial !important; background-repeat: initial !important;">1</div></td><td class="code" style="width: 773px; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-size: 1em !important; margin: 0px !important; padding: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: inherit !important; background: none !important;"><div class="container" style="box-sizing: content-box !important; font-size: 1em !important; margin: 0px !important; padding: 0px !important; width: auto !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: relative !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: inherit !important; background: none !important;"><div class="line number1 index0 alt2" style="box-sizing: content-box !important; font-size: 1em !important; margin: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; padding: 0.2em 1em !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: inherit !important; white-space: pre !important; background-image: none !important; background-attachment: initial !important; background-size: initial !important; background-origin: initial !important; background-clip: initial !important; background-position: initial !important; background-repeat: initial !important;"><code class="bash plain" style="box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-size: 1em !important; margin: 0px !important; padding: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: inherit !important; background: none !important;">-Dspring.profiles.active=</code><code class="bash string" style="box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-size: 1em !important; margin: 0px !important; padding: 0px !important; color: blue !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: inherit !important; background: none !important;">&quot;production&quot;</code></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;">而开发环境中不需要定义该参数，如果不定义，则会使用我们指定的默认 profile ，在这里也就是名称为 development 的 profile。<span style="box-sizing: border-box; margin: 0px; line-height: 1.5;">这样当项目部署到不同的环境时，便可以通过&nbsp;</span><span style="box-sizing: border-box; margin: 0px; line-height: 1.5;">JVM 参数来实现不同环境 profile 自动激活。</span></p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="box-sizing: border-box; margin: 0px; line-height: 1.5;"><br style="box-sizing: border-box; margin: 0px;"></span></p><h4 style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 18px; margin: 10px 0px; font-weight: 500; line-height: 1.1; color: rgb(85, 85, 85);"><span style="box-sizing: border-box; font-size: 14px; margin: 0px; line-height: 1.5;"><span style="box-sizing: border-box; margin: 0px; font-weight: 600;">4. 延伸</span></span></h4><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="box-sizing: border-box; margin: 0px; line-height: 1.5;">该参数还可以延伸，以至于我们可以在 java 代码中继续通过该参数来区分不同的环境，从而执行不同的操作，代码如下</span></p><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_6_138916" code_snippet_id="1661280" snippet_file_name="blog_20160425_6_138916" name="code" class="java">public class Config {
      public static String ENV = &quot;development&quot;;
}
public class InitConfigListener implements ServletContextListener {
    public void contextInitialized(ServletContextEvent sce) {
        //侦测jvm环境，并缓存到全局变量中
        String env = System.getProperty(&quot;spring.profiles.active&quot;);
        if(env == null) {
            Config.ENV = &quot;development&quot;;
        } else {
            Config.ENV = env;
        }
    }
}</pre><br><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;">在项目初始化时获取到该参数后，我们便可以在项目任何位置使用，来执行一些不同环境需要区别对待的操作，例如统计流量的代码只需要在生产环境激活，就可以在jsp中加入如下代码</span><br><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"></span></span></p><pre code_snippet_id="1661280" snippet_file_name="blog_20160425_7_5537109" code_snippet_id="1661280" snippet_file_name="blog_20160425_7_5537109" name="code" class="javascript">&lt;!-- 生产环境统计、推送代码 --&gt;
&lt;c:if test=&quot;${env == 'production' }&quot;&gt;
&lt;script&gt;
//统计代码
..
&lt;/script&gt;
&lt;/c:if&gt;</pre><br><p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;">原文地址：http://blog.lifw.org/post/68990012</span></span></p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"><br></span></span></p><p style="box-sizing: border-box; font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px; color: rgb(85, 85, 85); line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"><span style="color: rgb(85, 85, 85); font-family: 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif; font-size: 14px; line-height: 25.2000007629395px;"><br></span></span></p>   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/51243985'>原文链接</a>