<div style="color:blue" align=center>[WF40实战]WPF+WCF+WF打造HelloWorld（基础篇）</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">本篇博客是一个基础的示例，也就是一个入门教程吧！让大家熟悉一下</span><span lang="en-US">WPF &#43; WCF &#43; WF</span><span lang="zh-CN">三者的关系！这只是一个基础篇，下篇会继续深入，作为这段时间研究工作流的一个小小总结！</span></span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">三者关系：</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;</span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="en-US">WPF--</span><span lang="zh-CN">客户端</span><span lang="en-US">--</span><span lang="en-US">View</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="en-US">WF--</span><span lang="zh-CN">流转</span><span lang="en-US">--</span><span lang="en-US">Controller</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="en-US">WCF--</span><span lang="zh-CN">对外提供服务的</span><span lang="en-US">--</span><span lang="en-US">Model</span></span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;</span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">下面是一个示例，用这个示例再来理解一下为什么我将三者的关系分别映射为</span><span lang="en-US">MVC</span><span lang="zh-CN">的各层</span></span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;</span></p>
<h1 style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">WCF:</span></h1>
<p lang="en-US" style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">新建一个“控制台应用程序”，然后建立接口和相应的实现类</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="22057708535684" alt=""><br>
</span></p>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">实现相应的方法：</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;</span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312">接口：接口和方法需要对外公开，添加相应的引用ServiceModel</span></p>
<span style="font-family:KaiTi_GB2312"></span><pre name="code" class="csharp">namespace MyHelloWorld
{
  [ServiceContract]
   public interface IAppServer
    {
       [OperationContract]
       string GetStringFromWCF();
    }
}</pre>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">实现类：</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"></span></p>
<pre name="code" class="csharp">namespace MyHelloWorld
{
   public class AppServer:IAppServer
    {
        #region IAppServer成员
           public string GetStringFromWCF() {
               return &quot;Hello World&quot;;
           }
        #endregion
    }
}</pre>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">编写宿主程序：</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"></span></p>
<pre name="code" class="csharp">class Program
    {
        static void Main(string[] args)
        {
            using (ServiceHost host = new ServiceHost(typeof(AppServer)))
            {
                host.Open();
                Console.WriteLine(&quot;服务已经启动&quot;);
                Console.ReadLine();
            }

        }
    }</pre>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">引入相应的</span><span lang="en-US">App.config</span></span></p>
<span style="font-family:KaiTi_GB2312"></span><pre name="code" class="html">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;configuration&gt;
    &lt;system.serviceModel&gt;
        &lt;behaviors&gt;
            &lt;serviceBehaviors&gt;
                &lt;behavior name=&quot;&quot;&gt;
                    &lt;serviceMetadata httpGetEnabled=&quot;true&quot; /&gt;
                    &lt;serviceDebug includeExceptionDetailInFaults=&quot;true&quot; /&gt;
                &lt;/behavior&gt;
            &lt;/serviceBehaviors&gt;
        &lt;/behaviors&gt;
        &lt;services&gt;
            &lt;service name=&quot;MyHelloWorld.AppServer&quot;&gt;
                &lt;endpoint address=&quot;&quot; binding=&quot;basicHttpBinding&quot; contract=&quot;MyHelloWorld.IAppServer&quot;&gt;
                &lt;/endpoint&gt;
                &lt;host&gt;
                    &lt;baseAddresses&gt;
                        &lt;add baseAddress=&quot;http://localhost:8080/MyHelloWorld/AppServer/&quot; /&gt;
                    &lt;/baseAddresses&gt;
                &lt;/host&gt;
            &lt;/service&gt;
        &lt;/services&gt;
    &lt;/system.serviceModel&gt;
&lt;/configuration&gt;
</pre><br>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">启动服务测试：</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="11026518673457" alt=""><br>
</span>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">此时我们可以查看对外公开的服务以及它的描述文件：<br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp;<img src="26314885321236" alt=""><br>
</span></p>
<p style="margin:0in; font-size:14pt">
<p lang="en-US" style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;<img src="4309019658853" alt=""><br>
</span></p>
<p lang="en-US" style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<h1 style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">WF:</span></h1>
<p lang="en-US" style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">新建工作流的“活动库”（</span><span lang="en-US">WFProject</span><span lang="zh-CN">）</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN"><br>
</span></span></p>
<span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="16086897431585" alt=""><br>
</span>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">&nbsp; &nbsp;&nbsp;<img src="42124686388995" alt=""></span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">将</span><span lang="en-US">send</span><span lang="zh-CN">设置为参数类型</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN"><br>
</span></span></p>
<span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="38509696919345" alt=""></span>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="en-US"><br>
</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="en-US">send</span><span lang="zh-CN">相当于请求发送过去了，即请求服务的方法，那么就应该有个响应，而响应的结果就应该赋给我们之前定义的那个输出参数（</span><span lang="en-US">returnView</span><span lang="zh-CN">）</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">而返回的结果名称规则为调用的服务端的名称</span><span lang="en-US">&#43;result</span><span lang="zh-CN">后缀</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp;<img src="5019998012942" alt=""></span></p>
<span style="font-family:KaiTi_GB2312"><br>
</span>
<p style="margin:0in; font-size:14pt">
<h1 style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">WPF:</span></h1>
<p lang="en-US" style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp;</span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">新建</span><span lang="en-US">WPF</span><span lang="zh-CN">应用程序（</span><span lang="en-US">WPFProject</span><span lang="zh-CN">）</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN"><br>
</span></span></p>
<span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="8034435607089" alt=""><br>
</span>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">添加相应的引用</span><span lang="zh-CN">usingSystem.Activities;</span><span lang="zh-CN">以及</span><span lang="en-US">WFProject</span></span></p>
<span style="font-family:KaiTi_GB2312"></span><pre name="code" class="html">namespace WPFProject
{
    /// &lt;summary&gt;
    /// MainWindow.xaml 的交互逻辑
    /// &lt;/summary&gt;
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            IDictionary&lt;string, object&gt; results = WorkflowInvoker.Invoke(new WFProject.Activity1());
            string result = results[&quot;returnView&quot;].ToString();
            MessageBox.Show(result);
            
        }
    }
}
</pre><br>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">设置为多启动项</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="41679669803866" alt=""></span>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">最终的运行结果为：</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp;<img src="16366046714862" alt=""></span>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">附上整个解决方法的说明：<br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="26256956747684" alt=""></span></p>
<p style="margin:0in; font-size:14pt">
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">好了，整个程序已经完成了，这是一个非常基础的示例，目的是让大家对</span><span lang="en-US">WPF,WF,WCF</span><span lang="zh-CN">有一个简单的理解。</span></span></p>
<p lang="en-US" style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312">WPF--WebForm</span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="en-US">WF---</span><span lang="zh-CN">简单的逻辑调用</span><span lang="en-US">B</span><span lang="zh-CN">层</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="en-US">WCF--</span><span lang="zh-CN">方法的实现</span><span lang="en-US">D</span><span lang="zh-CN">层</span></span></p>
<p style="margin:0in; font-size:14.0pt"><span style="font-family:KaiTi_GB2312"><span lang="zh-CN">这篇博客还没有真正的应用上这个</span><span lang="en-US">WF</span><span lang="zh-CN">的流程自动控制过程，只是起了一个简单的调用的作用，下篇将细化</span><span lang="en-US">WF</span><span lang="zh-CN">的使用！</span></span></p>
<span style="font-family:KaiTi_GB2312"><br>
</span>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<p style="margin:0in; font-size:14pt"><span style="font-family:KaiTi_GB2312"><br>
</span></p>
<br>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/39935417'>原文链接</a>