<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; 市委组织部项目word上传，下载，预览，删除</div><div style="color:blue" align=center>市委组织部项目word上传，下载，预览，删除</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">需求：市委组织部考核项目，既然是考核项目就会有很多考核标准要求等，而且各个下属单位对于被考核指标的结果需要上传。这些过程都是通过文档实现的。也就是需要</span><span lang="en-US">word</span><span lang="zh-CN">文档的上传，下载，预览等功能。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">Word</span><span lang="zh-CN">上传：</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="13436609608504" alt=""><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"></span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">后台代码：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in">
<pre code_snippet_id="194717" snippet_file_name="blog_20140219_1_7639878" name="code" class="csharp">&lt;span style=&quot;font-family:KaiTi_GB2312;font-size:24px;&quot;&gt;        /// &lt;summary&gt;
        /// word上传
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;

        protected void btnUpWord_Click(object sender, EventArgs e)
        {
            string newName = &quot;&quot;;
            string flex = &quot;&quot;;
            string wjlj = &quot;&quot;;
           
           //事务开始——
            using (TransactionScope tx = new TransactionScope())
            { 
            try
            {

                if (Request.Files.Count &gt; 0)
                {
                    Random ro = new Random();
                    if (FileUpload2.FileName != &quot;&quot;)
                    {                       
                            //文档全称
                            string filename = Path.GetFileName(FileUpload2.FileName).Trim ();
                            //无后缀名的文档名称
                            string filemainname = (Path.GetFileNameWithoutExtension(FileUpload2.FileName)).Trim ();
                            //文档后缀名
                            flex = (Path.GetExtension(FileUpload2.FileName)).Trim ();
                            if (flex == &quot;.doc&quot; || flex == &quot;.docx&quot;)
                            {
                                //string stro = ro.Next(100, 1000000).ToString();
                                //string stro = DateTime.Now.ToString(&quot;yyyyMMdd&quot;);
                                //newName = DateTime.Now.Minute.ToString() + DateTime.Now.Second.ToString() + DateTime.Now.Millisecond.ToString() + stro;           

                                //上传后添加数据在数据库中
                                WordEntity enWord = new WordEntity();
                                //enWord.WordAddress= Server.MapPath(&quot;UpLoadWord/&quot;) + FileUpload2.FileName;
                                wjlj = &quot;UpLoadWord/&quot; + filemainname + newName + flex;
                                enWord.WordAddress = wjlj;
                                enWord.WordName = filename;
                                DateTime now = DateTime.Now;
                                enWord.StrDate = DateTime.Now.ToString(&quot;yyyy-MM-dd&quot;);
                                enWord.StrYear = now.Year.ToString();
                                //enWord.UnitName=Session[&quot;UserName&quot;].ToString ();
                                enWord.UnitName = &quot;hejingyuan&quot;;
                                WordBLL wordBll = new WordBLL();
                                //判断此单位是否已经上传过这个文档了,参数，文档名称和提交单位
                                bool isExist = wordBll.Exists(filename);
                                if (isExist == false)
                                {
                                    bool flag = wordBll.Add(enWord);
                                    if (flag == false)
                                    {
                                        MessageBox.Show(this, &quot;word上传失败，请联系管理员！&quot;);
                                        throw new Exception();
                                        //return;
                                    }
                                    else
                                    { //保有存文件到目录下  
                                        //FileUpload2.PostedFile.SaveAs(Server.MapPath(&quot;UpLoadWord/&quot;) + newName + flex);
                                        FileUpload2.PostedFile.SaveAs(Server.MapPath(&quot;UpLoadWord/&quot;) + newName + filename);
                                        //wjlj = &quot;UpLoadWord/&quot; + filemainname + newName + flex;
                                        Response.Write(&quot;&lt;script&gt;alert(&#39;保存成功&#39;);location.replace(location.href)&lt;/script&gt;&quot;);
                                    }
                                }
                                else
                                {
                                    //MessageBox.Show(this, &quot;word上传失败，此文档已经存在！&quot;);
                                    //File.Delete(Server.MapPath(&quot;UpLoadWord/&quot;) + FileUpload2.FileName);
                                    Response.Write(&quot;&lt;script&gt;alert(&#39;word上传失败，此文档已经存在！&#39;);location.replace(location.href)&lt;/script&gt;&quot;);
                                    //return;
                                }
                            }
                            else {
                                System.Web.HttpContext.Current.Response.Write(&quot;&lt;script language=&#39;javascript&#39;&gt;alert(&#39;导入文件格式不对,导入文件必须为Word文件!&#39;);;window.location.href=&#39;&quot; + System.Web.HttpContext.Current.Request.ServerVariables[&quot;HTTP_REFERER&quot;] + &quot;&#39;&lt;/script&gt;&quot;);
                                System.Web.HttpContext.Current.Response.End();
                            }
                    }
                }
                //string sql = string.Format(&quot;insert into zl(xh, wdmc, wdlj)values (&#39;{0}&#39;,&#39;{1}&#39;,&#39;{2}&#39;)&quot;, Guid.NewGuid().ToString(), wdmc, wjlj);
                //执行SQL语句,省略.....              
                tx.Complete();
                
            }
            catch (Exception)
            {
                File.Delete(Server.MapPath(&quot;UpLoadWord/&quot;) + FileUpload2.FileName);
                Response.Write(&quot;&lt;script&gt;alert(&#39;保存错误,请联系管理员！&#39;);location.replace(location.href)&lt;/script&gt;&quot;);
            }
            finally
            {
                //释放资源
                tx.Dispose();
            }
          }
        }
&lt;/span&gt;</pre><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span>
<p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">W</span><span lang="en-US">ord</span><span lang="zh-CN">预览，下载，删除，查询。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;<img src="40039739874877" alt=""><br>
</span>
<p style="margin:0in">
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">年份：根据年份进行筛选信息。文件名</span><span lang="en-US">:</span><span lang="zh-CN">模糊查询</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">预览效果：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;<img src="23240159615096" alt=""><br>
</span></p>
<p style="margin:0in"><br>
</p>
<p style="margin:0in"><br>
</p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">前台代码：</span></p>
<span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span>
<p style="margin:0in">
<pre code_snippet_id="194717" snippet_file_name="blog_20140219_2_9210824" name="code" class="html">&lt;span style=&quot;font-family:KaiTi_GB2312;font-size:24px;&quot;&gt;&lt;span&gt;年　份:&#160;&lt;/span&gt;
        &lt;asp:DropDownList ID=&quot;YearName&quot; runat=&quot;server&quot; editable=&quot;false&quot; panelHeight=&quot;auto&quot; class=&quot;easyui-combobox&quot; required=&quot;true&quot; Width=&quot;131px&quot;&gt;&lt;/asp:DropDownList&gt;&#160;&#160;&#160;&#160;        
        &lt;label class=&quot;first txt-green&quot;&gt;文件名:&#160;&lt;/label&gt;
        &lt;asp:TextBox ID=&quot;txtWordName&quot; runat=&quot;server&quot;&gt;&lt;/asp:TextBox&gt;&#160;&#160;
        &lt;%-- 何静媛 2014年2月18日 ,模糊查询 文本框输入进行限制,防止SQL注入 ErrorMessage=&quot;请输入模糊查询条件&quot;--%&gt;
            &lt;%--&lt;asp:LinkButton ID=&quot;btnSearch&quot; class=&quot;btn-lit btn-middle&quot; runat=&quot;server&quot; onclick=&quot;queryYear()&quot;  ValidationGroup=&quot;fuzzyQueryExam&quot;  &gt;&lt;span&gt;查询&lt;/span&gt;&lt;/asp:LinkButton&gt;--%&gt;                  
            &lt;asp:RequiredFieldValidator ID=&quot;RequiredFieldValidator1&quot; runat=&quot;server&quot;  ControlToValidate=&quot;txtWordName&quot; ValidationGroup=&quot;fuzzyQueryExam&quot; Display=&quot;Dynamic&quot; &gt;&lt;/asp:RequiredFieldValidator&gt;
            &lt;asp:RegularExpressionValidator ID=&quot;RegularExpressionValidator1&quot; runat=&quot;server&quot; ControlToValidate=&quot;txtWordName&quot; ValidationGroup=&quot;fuzzyQueryExam&quot;
                ErrorMessage=&quot;请输入汉字,数字,字母或下划线_!&quot; 
                ValidationExpression=&quot;^[a-zA-Z0-9_\u4e00-\u9fa5]+$&quot; Display=&quot;Dynamic&quot;&gt;&lt;/asp:RegularExpressionValidator&gt;
       &lt;%-- 结束 何静媛 2014年2月18日 --%&gt;
        &lt;a href=&quot;#&quot; class=&quot;easyui-linkbutton&quot; onclick=&quot;queryYear();&quot; data-options=&quot;&quot;&gt;查询&lt;/a&gt; 


 &lt;div style=&quot;margin:10px 0;&quot;&gt;&lt;/div&gt;
    &lt;div id=&quot;toolbar&quot; style=&quot;padding:5px;&quot;&gt;
        &lt;a href=&quot;javascript:void(0)&quot; class=&quot;easyui-linkbutton&quot; iconcls=&quot;icon-ok&quot; onclick=&quot;btnDownLoad()&quot;&gt;下载word文档&lt;/a&gt;
        &lt;%--&lt;a href=&quot;javascript:void(0)&quot; id=&quot;btnLoad&quot; class=&quot;easyui-linkbutton&quot; plain=&quot;true&quot;  onclick=&quot;btnDownLoad()&quot; onclick=&quot;btnLoad_Click&quot;&gt;下载&lt;/a&gt;--%&gt;
        &lt;asp:LinkButton ID=&quot;btnLoad&quot; style=&quot;display:none&quot; runat=&quot;server&quot; onclick=&quot;btnLoad_Click&quot; &gt;下载&lt;/asp:LinkButton&gt;
        &lt;%--&lt;asp:LinkButton ID=&quot;btnPreView&quot; style=&quot;display:none&quot; CssClass=&quot;easyui-linkbutton&quot; runat=&quot;server&quot; OnClick=&quot;btnConvert_Click&quot;&gt;预览swf&lt;/asp:LinkButton&gt;--%&gt;
        &lt;asp:LinkButton ID=&quot;btnPreView&quot; style=&quot;display:none&quot; CssClass=&quot;easyui-linkbutton&quot; runat=&quot;server&quot; OnClick=&quot;WordtoHtml_Click&quot;&gt;预览html&lt;/asp:LinkButton&gt;
        &lt;a href=&quot;javascript:void(0)&quot; class=&quot;easyui-linkbutton&quot;  onclick=&quot;javascript:btnPreView()&quot;&gt;预览HTML&lt;/a&gt;
        &lt;asp:LinkButton ID=&quot;btnRemove&quot; style=&quot;display:none&quot; CssClass=&quot;easyui-linkbutton&quot; runat=&quot;server&quot; OnClick=&quot;DelectWord_Click&quot;&gt;删除文档&lt;/asp:LinkButton&gt;
        &lt;a href=&quot;javascript:void(0)&quot; class=&quot;easyui-linkbutton&quot; iconcls=&quot;icon-remove&quot; plain=&quot;true&quot; onclick=&quot;destroyWord()&quot;&gt;删除文档&lt;/a&gt;
    &lt;/div&gt;   
&lt;/span&gt;</pre><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span>
<p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">js</span><span lang="zh-CN">代码：</span></span></p>
<span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span>
<p style="margin:0in">
<pre code_snippet_id="194717" snippet_file_name="blog_20140219_3_7367661" name="code" class="javascript">&lt;span style=&quot;font-family:KaiTi_GB2312;font-size:24px;&quot;&gt;&lt;script type=&quot;text/javascript&quot;&gt;
        
        //下载
        function btnDownLoad() {
            var row = $(&#39;#dg&#39;).datagrid(&#39;getSelected&#39;);
            if (row) {
                //选中行的id，文档名称，文档地址
                var id = row.id;
                var name = row.wordName;
                var wordaddress = row.wordAddress;

                //createXMLHTTP(); //创建XMLHttpRequest对象  + &quot;&amp;wordaddress=&quot; + wordaddress
                //var url = &quot;QueryWord.aspx?name=&quot; + name + &quot;&amp;wordaddress=&quot; + wordaddress;

                //js跳转页
                //window.location.href = &quot;QueryWord.aspx?name=&quot; + name;

                //调用后台click方法
                //document.getElementById(&quot;btnLoad&quot;).click();

                //var myurl = &quot;QueryWord.aspx&quot; + &quot;?&quot; + &quot;name=&quot; + name + &quot;&amp;wordaddress=&quot; + wordaddress;
                var myurl = wordaddress;
                //当跳转为文档的地址时，即实现下载
                window.location.assign(myurl);


            }
            else {
                alert(&#39;请选中一条记录进行修改&#39;);
                return;
            }
        }
        //预览
        function btnPreView() {
            var row = $(&#39;#dg&#39;).datagrid(&#39;getSelected&#39;);

            if (row) {
                var wordaddress = row.wordAddress;
                //将获取到的选中行地址赋给隐藏控件
                document.getElementById(&quot;HiddenField1&quot;).value = wordaddress;
                //js调用后台的click方法
                document.getElementById(&quot;btnPreView&quot;).click();
            }
            else {
                alert(&#39;请选中一条记录进行修改&#39;);
                return;
            }
        }
        //删除
        function destroyWord() {
            var row = $(&#39;#dg&#39;).datagrid(&#39;getSelected&#39;);

            if (row) {
                var id = row.id;
                var wordName = row.wordName;
                //将获取到的选中行地址赋给隐藏控件

                document.getElementById(&quot;HiddenField2&quot;).value = id;
                document.getElementById(&quot;HiddenField3&quot;).value = wordName;
                //js调用后台的click方法
                document.getElementById(&quot;btnRemove&quot;).click();
            }
            else {
                alert(&#39;请选中一条记录进行修改&#39;);
                return;
            }
        }
        //重新加载页面           
        function reloadgrid() {

            //查询参数直接添加在queryParams中    

            var queryParams = $(&#39;#dg&#39;).datagrid(&#39;options&#39;).queryParams;
            getQueryParams(queryParams);
            $(&#39;#dg&#39;).datagrid(&#39;options&#39;).queryParams = queryParams;//传递值

            $(&quot;#dg&quot;).datagrid(&#39;reload&#39;);//重新加载table

        }
        //查询参数直接添加在queryParams中
        function queryYear() {           
            var queryParams = $(&#39;#dg&#39;).datagrid(&#39;options&#39;).queryParams;
            getQueryParams(queryParams);
            $(&#39;#dg&#39;).datagrid(&#39;options&#39;).queryParams = queryParams;  //传递参数值
            $(&#39;#dg&#39;).datagrid(&#39;reload&#39;);  //重新加载表信息datagrid

        }
        //查询并把数据传递给后台，数组
        function getQueryParams(queryParams) {
            var Category = $(&quot;#YearName&quot;).datebox(&quot;getText&quot;);
            var txtWordName = document.getElementById(&quot;txtWordName&quot;).value;
            queryParams.WordID = Category;
            queryParams.txtWordName = txtWordName;
            return queryParams;
        }
    &lt;/script&gt;
&lt;/span&gt;</pre><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
<br>
</span>
<p>
<span style="font-family:KaiTi_GB2312; font-size:24px">后台代码：<br>
</span>
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"></span></span></p>
<pre code_snippet_id="194717" snippet_file_name="blog_20140219_4_192344" name="code" class="csharp">&lt;span style=&quot;font-family:KaiTi_GB2312;font-size:24px;&quot;&gt;                /// &lt;summary&gt;
	        /// 窗体加载
	        /// &lt;/summary&gt;
	        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
	        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
	        protected void Page_Load(object sender, EventArgs e)
	        {
	            DropYear();
	        }
	        /// &lt;summary&gt;
	        /// 加载数据库中的年份
	        /// &lt;/summary&gt;
	        private void DropYear()
	        {
	            try
	            {
	                //是否需要多次调用
	                //加载管理端字典表中的数据
	                WordBLL wordBll = new WordBLL();
	                System.Data.DataTable dtYear = wordBll.QueryYear().Tables[0];
	                YearName.Items.Add(&quot;全部&quot;);
	                for (int i = 0; i &lt; dtYear.Rows.Count; i++)
	                {
	                    YearName.Items.Add(dtYear.Rows[i][&quot;strYear&quot;].ToString());
	                }
	
	            }
	            catch (Exception ex)
	            {
	                //MessageBox.Show(this.Page, ex.Message);
	            }
	
	        }
	                 /// &lt;summary&gt;
	        /// 调用转换
	        /// &lt;/summary&gt;
	        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
	        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
	        protected void WordtoHtml_Click(object sender, EventArgs e)
	        {
	            try
	            {   //word文档的地址
	                string strpath = HiddenField1.Value;
	                string HtmlPath = WordToHtml(Server.MapPath(strpath));
	                string rePath = HtmlPath.Substring(HtmlPath.IndexOf(&quot;UpLoadWord\\&quot;) + 11, HtmlPath.Length - HtmlPath.IndexOf(&quot;UpLoadWord\\&quot;) - 11);
	                Response.Redirect(&quot;UpLoadWord/&quot; + rePath);
	            }
	            catch {
	                MessageBox.Show(this, &quot;预览失败，请重新查看！&quot;);
	                return;
	            }
	        }
	
	        /// &lt;summary&gt;          
	        /// word转成html[把word文档换成同名的html文件,并返回其路径]         
	        /// &lt;/summary&gt;         
	        /// &lt;param name=&quot;wordFileName&quot;&gt;&lt;/param&gt;  
	        public string WordToHtml(object wordFileName)
	        {
	            //在此处放置用户代码以初始化页面            
	            ApplicationClass word = new ApplicationClass();
	            Type wordType = word.GetType();
	            Documents docs = word.Documents;
	
	            //打开文件            
	            Type docsType = docs.GetType();
	            Document doc = (Document)docsType.InvokeMember(&quot;Open&quot;, System.Reflection.BindingFlags.InvokeMethod, null, docs, new Object[] { wordFileName, true, true });
	            //转换格式，另存为             
	            Type docType = doc.GetType();
	            string wordSaveFileName = wordFileName.ToString();
	            string extendName = Path.GetExtension(wordSaveFileName);
	            string strSaveFileName = null;
	
	            if (extendName == &quot;.docx&quot;)
	            {
	                strSaveFileName = wordSaveFileName.Substring(0, wordSaveFileName.Length - 4) + &quot;html&quot;;
	
	            }
	            else if (extendName == &quot;.doc&quot;)
	            {
	                strSaveFileName = wordSaveFileName.Substring(0, wordSaveFileName.Length - 3) + &quot;html&quot;;
	
	            }
	            else
	            {
	                Response.Write(&quot;&lt;script&gt;alert(&#39;转换错误,请查看是否为doc或docx格式！&#39;);location.replace(location.href)&lt;/script&gt;&quot;);
	            }
	
	            object saveFileName = (object)strSaveFileName;
	
	            docType.InvokeMember(&quot;SaveAs&quot;, System.Reflection.BindingFlags.InvokeMethod, null, doc, new object[] { saveFileName, WdSaveFormat.wdFormatFilteredHTML });
	            docType.InvokeMember(&quot;Close&quot;, System.Reflection.BindingFlags.InvokeMethod, null, doc, null);
	            //退出 Word              
	            wordType.InvokeMember(&quot;Quit&quot;, System.Reflection.BindingFlags.InvokeMethod, null, word, null);
	            return saveFileName.ToString();
	
	        }
	
	        //DelectWord_Click
	        /// &lt;summary&gt;
	        /// 删除上传的word文档
	        /// &lt;/summary&gt;
	        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
	        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
	        protected void DelectWord_Click(object sender, EventArgs e)
	        {
	            using (TransactionScope tx = new TransactionScope())
	            {
	                try
	                {
	                    //选中行的id值
	                    string id = HiddenField2.Value;
	                    //选中行的word文档名称
	                    string strName = HiddenField3.Value;
	                    //将删除数据库中的字段
	                    WordBLL wordbll = new WordBLL();
	                    //根据id删除数据库中的数据
	                    bool flag = wordbll.Delete(id);
	                    //删除服务器中的文档
	                    File.Delete(Server.MapPath(&quot;UpLoadWord/&quot;) + strName);
	                    
	                    //替换
	                    string name = strName.Replace(&quot;.docx&quot;, &quot;.html&quot;);
	                    name = name.Replace(&quot;.doc&quot;, &quot;.html&quot;);
	                    //string filename = strName.Replace(&quot;.docx&quot;, &quot;.files/&quot;);
	                    //filename = filename.Replace(&quot;.doc&quot;, &quot;.files/&quot;);
	
	                    File.Delete(Server.MapPath(&quot;UpLoadWord/&quot;) + name);
	                    //文件夹无法删除，每次生成的文件夹都是只读属性
	                    //File.Delete(Server.MapPath(&quot;UpLoadWord/&quot;) + filename);
	                   
	                    if (flag == true)
	                    {
	                        MessageBox.Show(this, &quot;删除文档成功！&quot;);
	                        tx.Complete();               
	                    }
	                    else
	                    {
	                        //MessageBox.Show(this, &quot;删除文档失败，请联系管理员！&quot;);
	                        throw new Exception();
	                    }
	                    
	                }
	                catch (Exception)
	                {                  
	                    Response.Write(&quot;&lt;script&gt;alert(&#39;删除失败,请联系管理员！&#39;);location.replace(location.href)&lt;/script&gt;&quot;);
	                    return;
	                }
	                finally
	                {
	                    //释放资源
	                    tx.Dispose();
	                }
	            }
	            //string HtmlPath = WordToHtml(Server.MapPath(strpath));
	            //string rePath = HtmlPath.Substring(HtmlPath.IndexOf(&quot;UpLoadWord\\&quot;) + 11, HtmlPath.Length - HtmlPath.IndexOf(&quot;UpLoadWord\\&quot;) - 11);
	            //Response.Redirect(&quot;UpLoadWord/&quot; + rePath);
	
	        }
	
&lt;/span&gt;</pre><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
<br>
</span>
<p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">总结：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in">
<p style="margin:0in"><span lang="zh-CN"><span style="font-family:宋体; font-size:16pt">&nbsp; &nbsp;</span><span style="font-family:KaiTi_GB2312; font-size:24px">以上只是对</span></span><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">word</span><span lang="zh-CN">上传，预览，下载，删除操作的代码罗列，整理出来方便以后查看，积累经验，其中的一些知识点会在后续的博客中继续总结！其中有一点需要大家注意就是存放在数据库中的文档地址字段“</span><span lang="en-US">\</span><span lang="zh-CN">”符号，因为“</span><span lang="en-US">\</span><span lang="zh-CN">”符号加一些字母通常会代表一些含义，固需要转义！</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN"><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp; &nbsp; 地址如下：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp; &nbsp; &nbsp; UpLoadWord\数据库系统原理实践报告.docx</span><span lang="en-US">--</span><span lang="zh-CN">无法查出数据</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp; &nbsp; &nbsp; UpLoadWord\\数据库系统原理实践报告.docx</span><span lang="en-US">--</span><span lang="zh-CN">能执行查询</span></span></p>
<br>
<p style="margin:0in; font-family:宋体; font-size:16.0pt"><br>
</p>
<p style="margin:0in; font-family:宋体; font-size:16.0pt"><br>
</p>
<p style="margin:0in; font-family:宋体; font-size:16.0pt"><br>
</p>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/19478117'>原文链接</a>