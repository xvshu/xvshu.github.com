<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; 【SSH基础】浅谈Hibernate关系映射（2）</div><div style="color:blue" align=center>【SSH基础】浅谈Hibernate关系映射（2）</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">继上篇博客</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">一对一关系映射：一对一关联映射在实际生活中是比较常见的，如人与身份证的关系，通过人这个对象可以找到他相关的内容。</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt"><img src="19275048008625" alt=""><br>
</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">一对一单向（主键）：</p>
<img src="18113747284188" alt=""><br>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt"><br>
</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">单向一对一主键关联，靠的是它们的主键相等，从Person中能看到IdCard，也就是把t_idCard中的主键拿过来当做t_Pseron的主键。</p>
<p style="margin:0in; font-size:14.0pt"><span lang="zh-CN" style="font-family:华文中宋">如图的线表示一个关联，在</span><span lang="en-US" style="font-family:Calibri">person</span><span lang="zh-CN" style="font-family:华文中宋">中可以看见</span><span lang="en-US" style="font-family:Calibri">idcard</span><span lang="zh-CN" style="font-family:华文中宋">。即在</span><span lang="en-US" style="font-family:Calibri">person</span><span lang="zh-CN" style="font-family:华文中宋">中持有</span><span lang="en-US" style="font-family:Calibri">idCard</span><span lang="zh-CN" style="font-family:华文中宋">的引用</span></p>
<p lang="en-US" style="margin:0in; font-family:Calibri; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-size:14.0pt"><span lang="en-US" style="font-family:Calibri">person</span><span lang="zh-CN" style="font-family:华文中宋">类的映射关系</span></p>
<pre name="code" class="html">&lt;hibernate-mapping&gt;
	&lt;class name=&quot;com.bjpowernode.hibernate.Person&quot; table=&quot;t_person&quot;&gt;
		&lt;id name=&quot;id&quot;&gt;
			&lt;!-- 采用foreign生成策略，foreign会取得关联对象的标识 --&gt;
			&lt;generator class=&quot;foreign&quot;&gt;
				&lt;!-- 指关联对象 --&gt;
				&lt;param name=&quot;property&quot;&gt;idCard&lt;/param&gt;
			&lt;/generator&gt;
		&lt;/id&gt;
		&lt;property name=&quot;name&quot;&gt;&lt;/property&gt;
		&lt;!-- one-to-one指示hibernate如何加载其关联对象，默认根据主键加载也就是
		拿到关键字段值，根据对端的主键来加载关联对象
		constrained=true表示，当前主键（person的主键）还是一个外键，参照了对端的主键
		（IdCard的主键），也就是会生成外键约束 --&gt;	
		&lt;one-to-one name=&quot;idCard&quot; constrained=&quot;true&quot;&gt;&lt;/one-to-one&gt;
	&lt;/class&gt;
	
&lt;/hibernate-mapping&gt;
</pre><br>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">
<p style="margin:0in; font-size:14.0pt"><span lang="en-US" style="font-family:Calibri">IdCard</span><span lang="zh-CN" style="font-family:华文中宋">的映射关系</span></p>
<p style="margin:0in; font-size:14.0pt"><span lang="zh-CN" style="font-family:华文中宋"></span></p>
<pre name="code" class="html">&lt;hibernate-mapping&gt;
	&lt;class name=&quot;com.bjpowernode.hibernate.IdCard&quot; table=&quot;t_idCard&quot;&gt;
		&lt;id name=&quot;id&quot;&gt;
			&lt;generator class=&quot;native&quot;/&gt;
		&lt;/id&gt;
		&lt;property name=&quot;cardNo&quot;/&gt;
	&lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><br>
<br>
<p>
<p style="margin:0in; font-size:14.0pt"><span lang="zh-CN" style="font-family:华文中宋">一对一双向（主键）：<br>
</span></p>
<p style="margin:0in; font-size:14.0pt"><span lang="zh-CN" style="font-family:华文中宋"><img src="12273317257104" alt=""><br>
</span></p>
<p style="margin:0in; font-size:14.0pt"><span lang="zh-CN" style="font-family:华文中宋"></span></p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">一对一双向主键关联与一对一单向主键关联的区别就是，一对一单向主键关联，在person端能看到idCard，而idCard不能看到Person端。而双向关联就是在idCard端也能看到person，也就是不但在Person.hbm.xml中加上&lt;one-to-one&gt;标签，同时在IdCard.hbm.xml文件中加上&lt;one-to-one&gt;标签。代码如下所示。</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-size:14.0pt"><span lang="en-US" style="font-family:Calibri">IdCard</span><span lang="zh-CN" style="font-family:华文中宋">的映射关系</span></p>
<pre name="code" class="html">&lt;hibernate-mapping&gt;
	&lt;class name=&quot;com.bjpowernode.hibernate.IdCard&quot; table=&quot;t_idCard&quot;&gt;
		&lt;id name=&quot;id&quot;&gt;
			&lt;generator class=&quot;native&quot;/&gt;
		&lt;/id&gt;
		&lt;property name=&quot;cardNo&quot;/&gt;
		&lt;one-to-one name=&quot;person&quot;&gt;&lt;/one-to-one&gt;
	&lt;/class&gt;
&lt;/hibernate-mapping&gt;
</pre><br>
<br>
<p style="margin:0in; font-size:14.0pt"><span lang="zh-CN" style="font-family:华文中宋"></span></p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">一对一单向映射（唯一外键关联）</p>
<img src="48408599176019" alt=""><br>
<p style="margin:0in; font-size:14.0pt"><span lang="zh-CN" style="font-family:华文中宋"></span></p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">一对一单向唯一外键关联，也就是多对一关联的特例，把多的一端限制为一，就是一对一唯一外键关联。同多对一一样，在一端加入另一端的并采用&lt;many-to-one&gt;标签，通过unique=&quot;true&quot;，这样来限制了多的一端为一。</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-size:14.0pt"><span lang="en-US" style="font-family:Calibri">person</span><span lang="zh-CN" style="font-family:华文中宋">的映射关系：</span></p>
<pre name="code" class="html">&lt;hibernate-mapping&gt;
	&lt;class name=&quot;com.bjpowernode.hibernate.Person&quot; table=&quot;t_person&quot;&gt;
		&lt;id name=&quot;id&quot;&gt;		
			&lt;generator class=&quot;native&quot;&gt;			
			&lt;/generator&gt;
		&lt;/id&gt;
		&lt;property name=&quot;name&quot;&gt;&lt;/property&gt;
		&lt;many-to-one name=&quot;idCard&quot; unique=&quot;true&quot;&gt;&lt;/many-to-one&gt;			
	&lt;/class&gt;
	
&lt;/hibernate-mapping&gt;
</pre><br>
<br>
<p style="margin:0in; font-size:14.0pt"><span lang="en-US" style="font-family:Calibri">IdCard</span><span lang="zh-CN" style="font-family:华文中宋">的映射关系：</span></p>
<pre name="code" class="html">&lt;hibernate-mapping&gt;
	&lt;class name=&quot;com.bjpowernode.hibernate.IdCard&quot; table=&quot;t_idCard&quot;&gt;
		&lt;id name=&quot;id&quot;&gt;
			&lt;generator class=&quot;native&quot;/&gt;
		&lt;/id&gt;
		&lt;property name=&quot;cardNo&quot;/&gt;
	&lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><br>
<br>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">即在t_person端加上一个外键字段idCard，限制idCard的唯一性就是一对一唯一外键关联。</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">一对一双向（唯一外键关联）</p>
<img src="18414279707237" alt=""><br>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">一对一唯一外键单向关联我们已经了解了，双向反过来就是在没有的一端加上就可以了。</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-size:14.0pt"><span lang="en-US" style="font-family:Calibri">IdCard</span><span lang="zh-CN" style="font-family:华文中宋">的映射关系：</span></p>
<pre name="code" class="html">&lt;hibernate-mapping&gt;
	&lt;class name=&quot;com.bjpowernode.hibernate.IdCard&quot; table=&quot;t_idCard&quot;&gt;
		&lt;id name=&quot;id&quot;&gt;
			&lt;generator class=&quot;native&quot;/&gt;
		&lt;/id&gt;
		&lt;property name=&quot;cardNo&quot;/&gt;
		&lt;!-- one-to-one指示hibernate如何加载其关联对象，默认根据主键加载也就是
		拿到关键字段值，根据对端的主键来加载关联对象
		property-ref=&quot;idCard&quot;拿本端的id和对端的idCard进行关联 --&gt;
		&lt;one-to-one name=&quot;person&quot; property-ref=&quot;idCard&quot;&gt;&lt;/one-to-one&gt;
	&lt;/class&gt;
&lt;/hibernate-mapping&gt;
</pre><br>
<br>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">从上述中可以总结出，对于一对一关联映射，主键关联和唯一外键关联单向和双向产生出的表结构是一样的，不同的是在加载的时候不同。也就是一对一双向关联和一对一单向关联的相比，只是改变了一对一关联映射的加载，而没有改变存储。</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">下面再来对比一下主键关联与唯一外键关联：</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">主键关联：即让两个对象具有相同的主键&#20540;，来表明它们之间的一一对应的关系，数据库表不会有额外的字段来维护它们之间的关系，仅通过表的主键来关联。</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">唯一外键关联：外键关联本来是用于多对一的配置，但是如果加上唯一的限制之后，也可以用来表示一对一的关联关系</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-size:14.0pt"><span lang="en-US" style="font-family:Calibri">One2one</span><span lang="zh-CN" style="font-family:华文中宋">不破坏表结构，不会再任何一端添加字段，只是在查找时，一起查找上来而已。主键关联不会改变存储，但是唯一外键关联会影响存储。对于如何选择，建议使用唯一外键关联！主键关联不易扩展，两个类间的依赖性太强。</span></p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">下篇继续！</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt">&nbsp;</p>
<p style="margin:0in; font-family:华文中宋; font-size:14.0pt"><br>
</p>
<br>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/38347181'>原文链接</a>