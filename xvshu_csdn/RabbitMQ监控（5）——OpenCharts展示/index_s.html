<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; RabbitMQ监控（5）——OpenCharts展示</div><div style="color:blue" align=center>RabbitMQ监控（5）——OpenCharts展示</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p>&nbsp; &nbsp; &nbsp; &nbsp; 有了前几篇博客的基础，我们可以从容应对监控的实现，但是还有一个问题，我们没有解决，就是图形化展示监控结果，在网页上画图，我们的确有很多种方案，以前我们使用过highcharts，但是学习还好，在公司使用不是很合适，我们需要一款，简单，易上手，的绘图插件，这里带领大家一起熟悉一款这样的软件，opencharts。</p>
<p>先看结果：</p>
<p><img src="40713065272645" alt=""><br>
</p>
<h1>一，简介</h1>
<p>OpenCharts是基于HTML Canvas技术的采用面向对象的Web图表，通过OpenCharts，你可以方便的制作一系列漂亮的Web图表。现在我们支持8种类型的图表表达方式，你可以通过帮助文档了解详细信息,也可以通过范例了解如何使用。<br>
</p>
<p>官方地址：<a target="_blank" target="_blank" href="https://github.com/pasu/OpenCharts">https://github.com/pasu/OpenCharts</a></p>
<p>效果展示：</p>
<p><img src="418544710323842" alt=""><br>
</p>
<p><br>
</p>
<p><br>
</p>
<h1>二，应用</h1>
<p><br>
</p>
<p>action代码：</p>
<p>
<pre code_snippet_id="1620710" snippet_file_name="blog_20160323_1_412939" name="code" class="java">/**
 * Created by Administrator on 2015/5/9.
 */
public class RabbitMQAction extends BaseAction {

    private IRabbitMenuService rabbitMenuService;

    public String index() throws Exception {
        String stringbid = request.getParameter(&quot;menId&quot;);
        RabbitMenu rabbitMenu =rabbitMenuService.selectByPrimaryKey(Integer.valueOf(stringbid));
        Result result = new Result(true);
        result.addDefaultModel(&quot;bid&quot;,rabbitMenu.getDomainName());
        toVm(result);
        return &quot;list&quot;;
    }

    public String  getCharDate(){
        String stringbid = request.getParameter(&quot;bid&quot;);
        HashMap&lt;String,String&gt; hashMap=null;
        String json = FileSaveMq.getDate();
        if(json==null||json.trim().isEmpty()){
            writeJson(&quot;&quot;);
        }else{
            hashMap = JSON.parseObject(json,HashMap.class);
        }

        if(hashMap!=null &amp;&amp; hashMap.containsKey(stringbid)){
            String values = hashMap.get(stringbid);
            List&lt;String&gt; list = JSON.parseObject(values,List.class);
            List&lt;Long&gt; listlong = new ArrayList&lt;Long&gt;();
            for(String one:list){
                listlong.add(Long.valueOf(one));
            }
            writeJson(listlong);
        }else{
            writeJson(&quot;&quot;);
        }
        return &quot;list&quot;;
    }

    public IRabbitMenuService getRabbitMenuService() {
        return rabbitMenuService;
    }

    public void setRabbitMenuService(IRabbitMenuService rabbitMenuService) {
        this.rabbitMenuService = rabbitMenuService;
    }
}
</pre><br>
<br>
<p>
<p>html代码：</p>
<p>
<pre code_snippet_id="1620710" snippet_file_name="blog_20160323_2_5505896" name="code" class="html">&lt;pre name=&quot;code&quot; class=&quot;html&quot;&gt;&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;

    &lt;script type=&quot;text/javascript&quot; src=&quot;$!homeModule.getTarget(&quot;/common/js/opencharts/OpenCharts-min.js&quot;)&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;$!homeModule.getTarget(&quot;/common/css/opencharts/style.css&quot;)&quot;&gt;
    &lt;script&gt;
        var bid =  $!bid;
        var charts1;
        $(function () {
            reflashchar();
        });
        function reflashchar(){
            $.post(&#39; $!homeModule.getTarget(&#39;/rabbitmq/getCharDate.action&#39;)&#39;, { bid:bid }, function (result) {
                if (result) {
                    logChar(result);
                }
                else {
                    $.messager.alert(&quot;提示信息&quot;, &quot;加载失败&quot;);
                }
            }, &#39;json&#39;);
        }

        function logChar(result){
            var items = [];
            var style = new OpenCharts.Style();
            style.fillStyle = &quot;#4169E1&quot;;
            var itemss = [];

            for(var i=0;i&lt;result.length;i++){
                if(i==0){
                    itemss.push({strCaption : 1,data :result[i],itemStyle:&#39;#D2691E&#39;});
                }else if((i+1)%10==0){
                    itemss.push(new OpenCharts.Item(result[i],i+1,&#39;#D2691E&#39;));
                }else if(i==(result.length-1)){
                    itemss.push(new OpenCharts.Item(result[i],i+1,&#39;#D2691E&#39;));
                }else{
                    itemss.push(new OpenCharts.Item(result[i],&#39;&#39;,&#39;#D2691E&#39;));
                }

            }
            var message = &quot;${itemName}${itemCaption}:[${itemData}]&quot;;
            charts1 = new OpenCharts.Chart.AreaChart(&quot;canvas1&quot;);
            charts1.strTitle = &quot;RabbitMQ 监控记录&quot;;
            charts1.addItems(itemss,&quot;Queue&quot;);
            charts1.addEventListener(&quot;mousedown&quot;,message);
            charts1.render();
        }

        var int=self.setInterval(&quot;reflashchar()&quot;,60000)
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div style=&quot;&quot;&gt;
    &lt;canvas id=&quot;canvas1&quot; height=&quot;600px&quot; width=&quot;1000px&quot;  /&gt;
&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</pre><br>
<br>
<pre></pre>
<p>
<p><br>
</p>
<h1>总结：</h1>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 再次重申，“世上无难事，只怕有心人”，大家一路跟过来，没有特别困哪的地方，但是就是简单工具的组合，就完成了好像很牛的功能，真的是好像很牛，这里不得不感谢奋斗在开源第一线孜孜不倦的人们！这就是这个时代，更开发，共享成为主旋律，打开我们自己，就能和大家一起拥抱更好的未来！</p>
<p><br>
</p>
<p><br>
</p>
<p><br>
</p>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/xvshu/article/details/50962724'>原文链接</a>