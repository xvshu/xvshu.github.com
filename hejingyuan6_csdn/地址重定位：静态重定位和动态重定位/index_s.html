<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; 地址重定位：静态重定位和动态重定位</div><div style="color:blue" align=center>地址重定位：静态重定位和动态重定位</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="line-height:26px"><span style="color:rgb(204,0,0)"><strong>地址重定位就是操作系统将逻辑地址转变为物理地址的过程。。。也就是对目标程序中的指令和数据进行修改的过程</strong></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="line-height:26px"><span style="color:rgb(204,0,0)"><strong><span style="font-family:arial,宋体,sans-serif; line-height:24px">将逻辑地址空间重定位到物理地址空间的时机有三种：</span></strong></span></span></p>
<div class="spctrl" style="font-family:Arial; height:14px; line-height:14px; overflow:hidden">
</div>
<span style="font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">　　1、程序编译连接时。</span>
<div class="spctrl" style="font-family:Arial; height:14px; line-height:14px; overflow:hidden">
</div>
<span style="font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">　　2、程序装入内存时。</span>
<div class="spctrl" style="font-family:Arial; height:14px; line-height:14px; overflow:hidden">
</div>
<span style="font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">　　3、程序执行时。</span><br style="font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="line-height:26px"><span style="color:rgb(204,0,0)"><strong><br>
</strong></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51); line-height:26px">以下内容转自：http://bbs.pediy.com/showthread.php?t=76876</span></p>
<span style="font-family:Arial; font-size:14px; line-height:26px; color:rgb(51,51,51)">　　在这之前我一直对地址重定位的细节不是很了解。以下文章摘自《操作系统原理DOS篇（第二版）》。是我目前看过的关于重定位的最好的文章。与大家分享 一下。<br>
　　以下介绍程序是如何装入内存，从而变成在计算机内可执行的形式的。<br>
　　在用汇编语言或高级语言编写的程序中，是通过符号名来访问子程序和数据的，我们把程序中符号名的集合叫做“名字空间”。汇编语言源程序经过汇编，或者高级语言源程序经过编译，得到的目标程序是以“0”作为参考地址的模块，然后多个目标模块由连接程序连接成一个具有统一地址的装配模块，以便最后装入内存中执行。我们把</span><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="color:rgb(0,102,0)"><strong>目标模块obj中的地址称为相对地址（或逻辑地址）</strong></span></span><span style="font-family:Arial; font-size:14px; line-height:26px; color:rgb(51,51,51)">，而把相对地址的集合叫做“相对地址空间”或简单地叫做“地址空间”。<br>
　　装配模块虽然具有统一的地址空间，但它仍是以“0”作为参考地址，即是浮动的。要把它装入内存执行，就要确定装入内存的实际物理地址，并修改程序中与 地址有关的代码，这一过程叫做地址重定位。<br>
　　地址空间的程序和数据经过地址重定位处理后，就变成了可由CPU直接执行的绝对地址程序。我们把这一地址集合称为“绝对地址空间”或“存储空间”。<br>
</span><span style="font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px"></span>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51); line-height:26px">　　地址重定位完成的相对地址转换成内存的绝对地址工作又称为地址映射（map）、按照重定位的时机，可分为静态重定位和动态重定位。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51); line-height:26px">&nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51); line-height:26px">&nbsp; &nbsp; &nbsp; &nbsp;重定位是由操作系统安排的。　　在装入程序前，系统会计算未使用的内存，然后将程序装入，并记下开始地址。在执行有相对地址的指令时，会将所有的地址加个刚才记下的开始地址，就叫重定位。<br>
</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51); line-height:26px"><br>
</span></p>
<span style="font-family:Arial; font-size:14px; line-height:26px"><strong><span style="color:rgb(204,0,0)">一、静态重定位</span></strong><br>
<span style="color:rgb(51,51,51)">　　</span><span style="color:rgb(0,102,0)"><strong>静态重定位是在程序执行之前进行重定位，它根据装配模块将要装入的内存起始位置，直接修改装配模块中的有关使用地址的指令。</strong></span><br>
<span style="color:rgb(51,51,51)">　　例如，一个以“0”作为参考地址的装配模块，要装入以100为起始地址的存储空间。显然，在装入之前要做某些修改，程序才能正确执行。例如，MOV　 EAX，[500]这条指令的意义，是把相对地址为500的存储单元内容1234装入EAX号累器。现在内容为1234的存储单元的实际地址为1500， 即为相对地址(500)加上装入的地址(1000),因此，MOV　EAX，[500]这条指令中的直接地址码也要相应地加上起始地址，而成为MOV　 EAX，[1500]。</span><br>
<span style="color:rgb(51,51,51)">　　程序中涉及直接地址的每条指令都要进行这样的修改。需要修改的位置称为重定位项，所做的加实际装入模块起始地址修改中的块起始地址称为重定位因子。</span><br>
<span style="color:rgb(51,51,51)">　　为支持静态重定位，连接程序在生成统一地址空间和装配模块时，　应产生一个重定位项表，连接程序此时还不知道装配模块将要装入的实际位置，故重定位表 所给出的需修改位置是相对地址所表示的位置。</span><br>
<span style="color:rgb(51,51,51)">　　操作系统的装入程序要把装配模块和重定位项表一起装入内存。由装配模块的实际装入起始地址得到重定位因子，然后实施如下两步：</span><br>
<span style="color:rgb(51,51,51)">　　（1）取重定位项，加上重定位因子而得到欲修改位置的实际地址；</span><br>
<span style="color:rgb(51,51,51)">　　（2）对实际地址中的内容再做加重定位因子的修改，从而完成指令代码的修改。</span><br>
<span style="color:rgb(51,51,51)">　　对所有的重定位项实施上述两步操作后，静态重定位才完成，尔后可启动程序执行。使用过的重定位项表内存副本随即被废弃。</span><br>
</span>
<p><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="color:rgb(51,51,51)">　　</span><span style="color:rgb(0,102,0)"><strong>静态重定位有着无需硬件支持的优点，但存在着如下的缺点：一是程序重定位之后就不能在内存中搬动了；二是要求程序的存储空间是连续的，不能把程序放在若干个不连续的区域内。</strong></span></span></p>
<p><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="color:rgb(0,102,0)"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">如图：</span><br>
</span></span></p>
<p><span style="font-family:Arial; color:#333333"><span style="font-size:14px; line-height:26px"><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="19068937978873" alt=""><br>
</strong></span></span></p>
<span style="font-family:Arial; font-size:14px; line-height:26px"><br>
<strong><span style="color:rgb(204,0,0)">二、动态重定位</span></strong><br>
<span style="color:rgb(51,51,51)">　　</span><span style="color:rgb(0,102,0)"><strong>动态重定位是指，不是在程序执行之前而是在程序执行过程中进行地址重定位。更确切地说，是在CPU每次访问内存单元前才进行地址变换。</strong></span><span style="color:rgb(51,51,51)">动态重定位可使装配模 块不加任何修改而装入内存，但是它需要硬件——定位寄存器的支持。</span><br>
<span style="color:rgb(51,51,51)">　　程序的目标模块装入内存时，与地址有关的各项均保持原来的相对地址不进行任何修改。如MOV　1，[500]这条指令仍是相对地址500。当此模块被 操作系统调度到处理机上执行时，操作系统将把此模块装入的实际起始起始地址减去目标模块的相对基地址，然后将其差&#20540;装入定位寄存器中。当CPU取得一条访 问内存的指令时，地址变换硬件逻辑自动将指令中的相对地址与定位寄存器中的&#20540;相加，再依此和&#20540;作为内存绝对地址去访问该单元中的数据。</span><br>
<span style="color:rgb(51,51,51)">　　由此可见，进行动态重定位的时机是在指令执行过程中，每次访问内存前动态地进行。采取动态重定位可带来两个好处：</span><br>
<span style="color:rgb(51,51,51)">　　（1）目标模块装入内存时无需任何修改，因而装入之后再搬迁也不会影响其正确执行，这对于存储器紧缩、解决碎片问题是极其有利的；</span><br>
<span style="color:rgb(51,51,51)">　　（2）一个程序由若干个相对独立的目标模块组成时，每个目标模块各装入一个存储区域，这些存储区域可以不是顺序相邻的，只要各个模块有自己对应的定位寄存器就行。</span><br>
</span><span style="font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px"></span>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="line-height:26px"><span style="color:rgb(51,51,51)">　　</span><span style="color:rgb(0,102,0)"><strong>动态重定位技术所付出的代价是需要硬件支持。</strong></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51)"><span style="line-height:26px"><br>
</span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px">
<span style="color:#333333"><span style="line-height:26px">如图：</span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px">
<span style="color:#333333"><span style="line-height:26px">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src="738056275815" alt="">
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>
</span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51)"><span style="line-height:26px"><br>
</span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(204,0,0)"><span style="line-height:26px"><strong>总结：</strong></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="color:rgb(51,51,51)"><span style="line-height:26px"><span style="font-size:16px"><strong>静态地址重定位</strong>：即在程序装入内存的过程中完成，是指在程序开始运行前，程序中的各个地址有关的项均已完成重定位，地址变换通常是在装入时一次完成的，以后不再改变，故成为静态重定位。</span></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="font-size:16px"><strong>优点：</strong>无需硬件支持</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="font-size:16px"><strong>缺点：</strong>1）程序重定位之后就不能在内存中搬动了；2）要求程序的存储空间是连续的，不能把程序放在若干个不连续的区域中。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="font-size:16px">&nbsp;</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="font-size:16px"><strong>动态地址重定位：</strong>不是在程序执行之前而是在程序执行过程中进行地址重定位。更确切的说，是在每次访问内存单元前才进行地址变换。动态重定位可使装配模块不加任何修改而装入内存，但是它需要硬件一定位寄存器的支持。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="font-size:16px"><strong>优点</strong>：1）目标模块装入内存时无需任何修改，因而装入之后再搬迁也不会影响其正确执行，这对于存储器紧缩、解决碎片问题是极其有利的；2）一个程序由若干个相对独立的目标模块组成时，每个目标模块各装入一个存储区域，这些存储区域可以不是顺序相邻的，只要各个模块有自己对应的定位寄存器就行。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14.44444465637207px; line-height:25.98958396911621px">
<span style="font-size:16px"><strong>缺点：</strong>需要硬件支持。</span></p>
<div><span style="font-size:16px"><br>
</span></div>
<div><span style="font-size:16px"><br>
</span></div>
<div><span style="font-size:16px"><br>
</span></div>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/24125265'>原文链接</a>