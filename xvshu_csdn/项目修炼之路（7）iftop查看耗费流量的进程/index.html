<div style="color:blue" align=center>项目修炼之路（7）iftop查看耗费流量的进程</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;我们知道在linux中，top命令可以查看服务器中资源的一些情况，cpu，内存等，还可以看到是谁在消耗内存或cpu，但是，有些时候，我们发现，cpu和内存并不吃紧，但是服务器依然很慢，这时候，我们需要多一个维度来帮助我们分析问题，就是流量的统计，今天给大家介绍一个工具iftop，希望帮助大家解决这个问题。</span></p>
<p><span style="font-size:18px"><br>
</span></p>
<p><span style="font-size:18px">iftop先睹为快：<br>
</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="25239757102144" alt=""><br>
</span></p>
<p>
<h1><span style="font-size:18px">1，界面介绍</span></h1>
<p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp; 界面上面显示的是类&#20284;刻度尺的刻度范围，为显示流量图形的长条作标尺用的。<br>
&nbsp; &nbsp; &nbsp; &nbsp; 中间的&lt;= =&gt;这两个左右箭头，表示的是流量的方向。<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; TX：发送流量<br>
&nbsp; &nbsp; &nbsp; &nbsp; RX：接收流量<br>
&nbsp; &nbsp; &nbsp; &nbsp; TOTAL：总流量<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Cumm：运行iftop到目前时间的总流量<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;peak：流量峰&#20540;<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;rates：分别表示过去 2s 10s 40s 的平均流量</span></p>
<span style="font-size:18px"><br>
</span>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;官网：http://www.ex-parrot.com/~pdw/iftop/</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp; 知道端口，我们可以通过 netstat -ntlup|grep 端口号 来查看具体进程，并通过ps -ef |grep 进程号，查看相关信息，这样就容易定位消费流量的大户是谁了！</span></p>
<span style="font-size:18px"><br>
<br>
</span>
<h1><span style="font-size:18px">2，准备：</span></h1>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;必要库文件，需要 libpcap 及 libcurses 。</span></p>
<span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;yum install -y flex byacc libpcap ncurses ncurses-devel libpcap-devel<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;指定目录：cd /usr/local/<br>
</span>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;下载：wget http://www.ex-parrot.com/~pdw/iftop/download/iftop-0.17.tar.gz</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;解压：tar zvfx iftop-0.17.tar.gz</span></p>
<p><span style="font-size:18px"><br>
</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;应用配置<br>
</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;cd iftop-0.17</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;./configure --prefix=/usr/local/iftop</span></p>
<p><span style="font-size:18px"><br>
</span></p>
<span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;编译：make &amp;&amp; make install<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;复制可执行文件到linux库：cp /usr/local/iftop/sbin/iftop /bin<br>
<br>
<br>
</span>
<h1><span style="font-size:18px">3， 运行iftop</span></h1>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;查看要监控的网卡名：ifconfig -a</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="34518565790327" alt=""><br>
</span></p>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;请必须是root级别用户</span></p>
<span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;iftop -i eth0 -n -P<br>
</span>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;更详细的参数可以iftop -h查看</span></p>
<p><span style="font-size:18px"><br>
</span></p>
<h1><span style="font-size:18px">总结：</span></h1>
<p><span style="font-size:18px">&nbsp; &nbsp; &nbsp; &nbsp;在linux上，通过安装一系列插件，实现对linux的扩充，这是操作系统，但是映射到java，不也是一样的吗？很多地方都是相同的，这就可以归类与一种结果：可扩充软件，也是常常我们说的做标准，可替换可扩充，和最近读到的一本数《黑客与画家》中对java的介绍是有共同点的，他是寻求的统一，模块，而不是定制，在统一，模块的基础上，解放出人，人，才可以被替换，这也是一种非常&#20540;得学习的理念！</span></p>
<p><span style="font-size:18px"><br>
</span></p>
<p><br>
</p>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/xvshu/article/details/50717798'>原文链接</a>