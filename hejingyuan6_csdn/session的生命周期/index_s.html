<div class="articleLocationOnion"><a href='../../index.html'>首页: </a> &gt; <a href='../index_s.html'>未分类</a> &gt; session的生命周期</div><div style="color:blue" align=center>session的生命周期</div><br><div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post">

<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US"><br>
</span></span></p>
<h1><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">session</span><span lang="zh-CN">简介</span></span></h1>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp; &nbsp; 在计算机专业术语中，</span><span lang="en-US">Session是指一个终端用户与交互系统进行通信的时间间隔，通常指从注册进入系统到注销退出系统之间所经过的时间以及如果需要的话，可能还有一定的操作空间。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp; &nbsp; 具体到</span><span lang="en-US">Web中的Session指的就是用户在浏览某个网站时，从进入网站到浏览器关闭所经过的这段时间，也就是用户浏览这个网站所花费的时间。因此从上述的定义中我们可以看到，Session实际上是一个特定的时间概念。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US"><br>
</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">需要注意的是，一个</span><span lang="en-US">Session的概念需要包括特定的客户端，特定的服务器端以及不中断的操作时间。A用户和C服务器建立连接时所处的Session同B用户和C服务器建立连接时所处的Session是两个不同的Session。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<h1><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">session</span><span lang="zh-CN">生命周期</span></span></h1>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp; &nbsp; Session<span lang="zh-CN">中的数据保存在服务器端，在客户端需要的时候创建</span><span lang="en-US">Session</span><span lang="en-US">，在客户端不需要的时候销毁</span><span lang="en-US">Session</span><span lang="en-US">，使它不再占用服务器内存。前面说了服务器并不管客户端是否依然存在，因而它也无法确定客户端什么时间不再使用它，但是如果在客户端不再用的时候不及时销毁</span><span lang="en-US">Session</span><span lang="en-US">的话，服务器很快就会内存不足。为了解决这个问题，给</span><span lang="en-US">Session</span><span lang="en-US">加了一个生命周期，当服务器发现</span><span lang="en-US">Session</span><span lang="en-US">超过了它的生命周期，就会释放该</span><span lang="en-US">Session</span><span lang="en-US">所占用的内存空间。</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">要了解</span><span lang="en-US">Session</span><span lang="en-US">首先要知道一个概念：</span><span lang="en-US">Session</span><span lang="en-US">的销毁只有两种情况：</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">第一：</span><span lang="en-US">session</span><span lang="en-US">调用了</span><span lang="en-US">session.invalidate()</span><span lang="en-US">方法</span><span lang="en-US">.</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="en-US">第二：前后两次请求超出了</span><span lang="en-US">session</span><span lang="en-US">指定的生命周期时间</span><span lang="en-US">.</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">第二种情况的解释：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px; color:#990000"><span lang="zh-CN">Session</span><span lang="zh-CN">生成后，只要用户继续访问，服务器就会更新</span><span lang="en-US">Session</span><span lang="en-US">的最后访问时间，并维护该</span><span lang="en-US">Session</span><span lang="en-US">。用户每访问服务器一次，无论是否读写</span><span lang="en-US">Session</span><span lang="en-US">，服务器都认为该用户的</span><span lang="en-US">Session&quot;</span><span lang="en-US">活跃（</span><span lang="en-US">active</span><span lang="en-US">）</span><span lang="en-US">&quot;</span><span lang="en-US">了一次。</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp; &nbsp; 在ASP.NET中Session的默认生命周期是20分钟，也就是当我们在9:00的时候设置了一个Session，如果在9:20之前客户端没有任何请求，那么它的生命周期就到9:20分钟结束。但是一旦用户在9:19又向服务器发送了一个请求，那么这个Session现在的生命周期就是在当前时间的基础上再加上20分钟，也就是此时这个Session的生命周期是到9:39结束。</span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp; &nbsp; 举例：当我们登陆一个网站，网站会记录我们的个人信息如用户名等，如果我们登陆了很长时间但是没有任何操作，那么</span><span lang="en-US">session</span><span lang="zh-CN">超时，我们再次操作时会让我们重新登陆。但是如果我们登陆后，一直在访问这个网站，就不会出现</span><span lang="en-US">session</span><span lang="zh-CN">超时的问题，我们也无需重新登陆。（个人理解）</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp; &nbsp; 由于会有越来越多的用户访问服务器，因此</span><span lang="en-US">Session</span><span lang="en-US">也会越来越多。为防止内存溢出，服务器会把长时间内没有活跃的</span><span lang="en-US">Session</span><span lang="en-US">从内存删除。这个时间就是</span><span lang="en-US">Session</span><span lang="en-US">的超时时间。如果超过了超时时间没访问过服务器，</span><span lang="en-US">Session</span><span lang="en-US">就自动失效了。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp; &nbsp; Session</span><span lang="zh-CN">的超时时间为</span><span lang="en-US">maxInactiveInterval</span><span lang="en-US">属性，可以通过对应的</span><span lang="en-US">getMaxInactiveInterval()</span><span lang="en-US">获取，通过</span><span lang="en-US">setMaxInactiveInterval(longinterval)</span><span lang="en-US">修改。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">Session</span><span lang="zh-CN">的超时时间也可以在</span><span lang="en-US">web.xml</span><span lang="en-US">中修改。另外，通过调用</span><span lang="en-US">Session</span><span lang="en-US">的</span><span lang="en-US">invalidate()</span><span lang="en-US">方法可以使</span><span lang="en-US">Session</span><span lang="en-US">失效。</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&lt;session-config&gt;&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">&nbsp;&nbsp;&nbsp;&lt;session-timeout&gt;60&lt;/session-timeout&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--</span><span lang="zh-CN">单位：分钟</span><span lang="en-US">--&gt;&nbsp;</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&lt;/session-config&gt;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">注意：</span><span lang="en-US">&lt;session-timeout&gt;</span><span lang="en-US">参数的单位为分钟，而</span><span lang="en-US">setMaxInactiveInterval(int s)</span><span lang="en-US">单位为秒。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">web.config里设置</span><span lang="en-US">&lt;</span><span lang="zh-CN">sessionState</span><span lang="en-US">&nbsp;timeout=&quot;30&quot;&gt;&lt;/sessionState&gt;</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">Session具有以下特点：</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">（<span lang="en-US">1</span><span lang="en-US">）</span><span lang="en-US">Session</span><span lang="en-US">中的数据保存在服务器端；</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">（</span><span lang="en-US">2</span><span lang="en-US">）</span><span lang="en-US">Session</span><span lang="en-US">中可以保存任意类型的数据；</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">（</span><span lang="en-US">2</span><span lang="en-US">）</span><span lang="en-US">Session</span><span lang="en-US">默认的生命周期是</span><span lang="en-US">20</span><span lang="en-US">分钟，可以手动设置更长或更短的时间。</span></span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><span lang="zh-CN">至于设置可以用代码设置或者在</span><span lang="en-US">Web.config</span><span lang="en-US">中配置，不过不建议将</span><span lang="en-US">Session</span><span lang="en-US">的超时时间设置过长，因为默认情况下</span><span lang="en-US">Session</span><span lang="en-US">在内存中保存，设置时间过长保存的数据过大的话会导致内存不足。</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">注意：新开的浏览器窗口会生成新的<span lang="en-US">Session</span><span lang="en-US">，但子窗口除外。子窗口会共用父窗口的</span><span lang="en-US">Session</span><span lang="en-US">。例如，在链接上右击，在弹出的快捷菜单中选择</span><span lang="en-US">&quot;</span><span lang="en-US">在新窗口中打开</span><span lang="en-US">&quot;</span><span lang="en-US">时，子窗口便可以访问父窗口的</span><span lang="en-US">Session</span><span lang="en-US">。</span></span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px">&nbsp;</span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
<p lang="en-US" style="margin:0in"><span style="font-family:KaiTi_GB2312; font-size:24px"><br>
</span></p>
   
</div><div class="ArcitleLink"><a href='http://blog.csdn.net/hejingyuan6/article/details/17076019'>原文链接</a>